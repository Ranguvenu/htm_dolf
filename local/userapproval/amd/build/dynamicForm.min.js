define("local_userapproval/dynamicForm",["exports","local_trainingprogram/dynamicform","core_form/modalform","core/modal_factory","core/modal_events","core/ajax","core/notification","core/templates","core/str"],(function(_exports,_dynamicform,_modalform,_modal_factory,_modal_events,_ajax,_notification,_templates,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_dynamicform=_interopRequireDefault(_dynamicform),_modalform=_interopRequireDefault(_modalform),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification),_templates=_interopRequireDefault(_templates);const Selectors_actions={createuser:'[data-action="createuser"]',deleteuser:'[data-action="deleteuser"]',approveuser:'[data-action="approveuser"]',rejectuser:'[data-action="rejectuser"]',viewregistration:'[data-action="viewuserregistration"]',rejectorgrequest:'[data-action="rejectorgrequest"]',approveorgrequest:'[data-action="approveorgrequest"]',deletebannerimage:'[data-action="bannerimage"]',rejectrequest:'[data-action="rejectrequest"]',approverequest:'[data-action="approverequest"]',itemenrolledlist:'[data-action="itemenrolledlist"]',cancelrequest:'[data-action="cancelrequest"]',editrequest:'[data-action="edit"]',deleterequest:'[data-action="deleterequest"]',sendemailtouser:'[data-action="sendemailtouser"]'};_exports.init=()=>{document.addEventListener("click",(function(e){let updaterequest=e.target.closest(Selectors_actions.editrequest);if(updaterequest){e.preventDefault();var userid=updaterequest.getAttribute("data-userid"),id=updaterequest.getAttribute("data-id"),requesttype=updaterequest.getAttribute("data-requesttype"),name=updaterequest.getAttribute("data-name");const title=(0,_str.get_string)("updaterequest","local_userapproval"),form=new _modalform.default({formClass:"local_userapproval\\form\\requestedit_form",args:{id:id,requesttype:requesttype,name:name,userid:userid},modalConfig:{title:title},returnFocus:updaterequest});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let requestdelete=e.target.closest(Selectors_actions.deleterequest);if(requestdelete){e.preventDefault();requestdelete.getAttribute("data-userid");const id=requestdelete.getAttribute("data-id"),requesttype=requestdelete.getAttribute("data-requesttype");_modal_factory.default.create({title:(0,_str.get_string)("confirm","local_userapproval"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("deleteconfirmation","local_userapproval")}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("deletetext","local_userapproval")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.id=id,params.requesttype=requesttype,_ajax.default.call([{methodname:"local_userapproval_deleterequest",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let element=e.target.closest(Selectors_actions.createuser);if(element){e.preventDefault(),e.stopImmediatePropagation();const title=element.getAttribute("data-id")?(0,_str.get_string)("edituser","local_userapproval",element.getAttribute("data-name")):(0,_str.get_string)("registernewuser","local_userapproval"),form=new _dynamicform.default({formClass:"local_userapproval\\form\\individual_registration_form",args:{id:element.getAttribute("data-id"),segment:element.getAttribute("data-segment"),jobfamily:element.getAttribute("data-jobfamily"),jobrole:element.getAttribute("data-jobrole")},modalConfig:{title:title},returnFocus:element});form.addEventListener(form.events.ERROR,(event=>{form.enableButtons()})),form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let deleteuserelement=e.target.closest(Selectors_actions.deleteuser);if(deleteuserelement){e.preventDefault(),e.stopImmediatePropagation();const userid=deleteuserelement.getAttribute("data-id"),username=deleteuserelement.getAttribute("data-name");_modal_factory.default.create({title:(0,_str.get_string)("confirm","local_userapproval"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("deleteconfirm","local_userapproval",username)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("deletetext","local_userapproval")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.userid=userid,params.username=username,_ajax.default.call([{methodname:"local_userapproval_deleteteuser",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let approveuserelement=e.target.closest(Selectors_actions.approveuser);if(approveuserelement){e.preventDefault(),e.stopImmediatePropagation();const userid=approveuserelement.getAttribute("data-id"),username=approveuserelement.getAttribute("data-name");_modal_factory.default.create({title:(0,_str.get_string)("approvedconfirm","local_userapproval"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("userapproveconfirm","local_userapproval",username)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("approvetext","local_userapproval")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.userid=userid,params.username=username,_ajax.default.call([{methodname:"local_userapproval_approveuser",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(ex){_notification.default.exception(ex)}))}.bind(this)),modal.show()}.bind(this))}let rejectuserelement=e.target.closest(Selectors_actions.rejectuser);if(rejectuserelement){e.preventDefault(),e.stopImmediatePropagation();const userid=rejectuserelement.getAttribute("data-id"),username=rejectuserelement.getAttribute("data-name");_modal_factory.default.create({title:(0,_str.get_string)("rejectedconfirm","local_userapproval"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("userrejectconfirm","local_userapproval",username)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("rejecttext","local_userapproval")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.userid=userid,params.username=username,_ajax.default.call([{methodname:"local_userapproval_rejectuser",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let viewregistrationelement=e.target.closest(Selectors_actions.viewregistration);if(viewregistrationelement){e.preventDefault(),e.stopImmediatePropagation();const requestid=viewregistrationelement.getAttribute("data-requestid"),userid=viewregistrationelement.getAttribute("data-id"),username=viewregistrationelement.getAttribute("data-name"),requesttype=viewregistrationelement.getAttribute("data-requesttype");var regtitle;regtitle=requesttype?"Trainer"==requesttype?(0,_str.get_string)("trainerdetails","local_userapproval"):(0,_str.get_string)("expertdetails","local_userapproval"):(0,_str.get_string)("viewregistration","local_userapproval");var params={};params.requestid=requestid,params.userid=userid,params.username=username,params.requesttype=requesttype,_ajax.default.call([{methodname:"local_userapproval_viewregistration",args:params}])[0].done((function(resp){_modal_factory.default.create({title:regtitle,type:_modal_factory.default.types.DEFAULT,body:resp.options}).done(function(modal){this.modal=modal,this.modal.setLarge(),modal.show()}.bind(this))})).fail((function(){console.log("exception")}))}let rejectorgrequest=e.target.closest(Selectors_actions.rejectorgrequest);if(rejectorgrequest){e.preventDefault(),e.stopImmediatePropagation();const requestid=rejectorgrequest.getAttribute("data-id"),orgid=rejectorgrequest.getAttribute("data-orgid"),userid=rejectorgrequest.getAttribute("data-userid"),username=rejectorgrequest.getAttribute("data-username"),orgname=rejectorgrequest.getAttribute("data-orgname");(displayparams={}).username=username,displayparams.orgname=orgname,_modal_factory.default.create({title:(0,_str.get_string)("orgrequestconfirm","local_userapproval"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("orgrequestrejectconfirm","local_userapproval",displayparams)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("orgrequestrejecttext","local_userapproval")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.requestid=requestid,params.orgid=orgid,params.userid=userid,_ajax.default.call([{methodname:"local_userapproval_rejectorgrequest",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let approveorgrequest=e.target.closest(Selectors_actions.approveorgrequest);if(approveorgrequest){e.preventDefault(),e.stopImmediatePropagation();const requestid=approveorgrequest.getAttribute("data-id"),orgid=approveorgrequest.getAttribute("data-orgid"),userid=approveorgrequest.getAttribute("data-userid"),username=approveorgrequest.getAttribute("data-username"),orgname=approveorgrequest.getAttribute("data-orgname");(displayparams={}).username=username,displayparams.orgname=orgname,_modal_factory.default.create({title:(0,_str.get_string)("orgrequestconfirm","local_userapproval"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("orgrequestapproveconfirm","local_userapproval",displayparams)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("orgrequestapprovetext","local_userapproval")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.requestid=requestid,params.orgid=orgid,params.userid=userid,_ajax.default.call([{methodname:"local_userapproval_approveorgrequest",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let deletebannerimageelement=e.target.closest(Selectors_actions.deletebannerimage);if(deletebannerimageelement){e.preventDefault(),e.stopImmediatePropagation();const userid=deletebannerimageelement.getAttribute("data-id");_modal_factory.default.create({title:(0,_str.get_string)("confirm","local_userapproval"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("deletebannerimageconfirm","local_userapproval")}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("deletetext","local_userapproval")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.userid=userid,_ajax.default.call([{methodname:"local_userapproval_deletebannerimage",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let rejectrequestelement=e.target.closest(Selectors_actions.rejectrequest);if(rejectrequestelement){e.preventDefault(),e.stopImmediatePropagation();const requestid=rejectrequestelement.getAttribute("data-id"),requesttype=rejectrequestelement.getAttribute("data-requesttype"),username=rejectrequestelement.getAttribute("data-name");(displayparams={}).username=username,displayparams.requesttype=requesttype,_modal_factory.default.create({title:(0,_str.get_string)("reject","local_userapproval"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("rejectconfirm","local_userapproval",displayparams)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("reject","local_userapproval")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.requestid=requestid,params.requesttype=requesttype,_ajax.default.call([{methodname:"local_userapproval_rejectrequest",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let approverequestelement=e.target.closest(Selectors_actions.approverequest);if(approverequestelement){e.preventDefault(),e.stopImmediatePropagation();const approverequestid=approverequestelement.getAttribute("data-id"),requesttype=approverequestelement.getAttribute("data-requesttype"),username=approverequestelement.getAttribute("data-name");(displayparams={}).username=username,displayparams.requesttype=requesttype,_modal_factory.default.create({title:(0,_str.get_string)("approve","local_userapproval"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("approveconfirm","local_userapproval",displayparams)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("approve","local_userapproval")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.approverequestid=approverequestid,params.requesttype=requesttype,_ajax.default.call([{methodname:"local_userapproval_approverequest",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let cancelrequestrequestelement=e.target.closest(Selectors_actions.cancelrequest);if(cancelrequestrequestelement){e.preventDefault(),e.stopImmediatePropagation();const cancelrequestidrequestid=cancelrequestrequestelement.getAttribute("data-id"),requesttype=cancelrequestrequestelement.getAttribute("data-requesttype"),username=cancelrequestrequestelement.getAttribute("data-name"),trainerorexpertid=cancelrequestrequestelement.getAttribute("data-trainerorexpertid");var displayparams;(displayparams={}).username=username,displayparams.requesttype=requesttype,displayparams.trainerorexpertid=trainerorexpertid,_modal_factory.default.create({title:(0,_str.get_string)("canceled","local_userapproval"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("cancelconfirm","local_userapproval",displayparams)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("confirm","local_userapproval")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.cancelid=cancelrequestidrequestid,params.requesttype=requesttype,params.trainerorexpertid=trainerorexpertid,_ajax.default.call([{methodname:"local_userapproval_cancelrequest",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let itemenrolledlist=e.target.closest(Selectors_actions.itemenrolledlist);if(itemenrolledlist){e.preventDefault(),e.stopImmediatePropagation();const userid=itemenrolledlist.getAttribute("data-id"),username=itemenrolledlist.getAttribute("data-name"),type=itemenrolledlist.getAttribute("data-type");if("exams"==type)var title=(0,_str.get_string)("examenrolledusers","local_userapproval");else if("programs"==type)title=(0,_str.get_string)("tpenrolledusers","local_userapproval");else if("events"==type)title=(0,_str.get_string)("eventenrolledusers","local_userapproval");var options={};options.userid=userid,options.username=username,options.type=type;var trigger=$(Selectors_actions.itemenrolledlist);_modal_factory.default.create({title:title,body:_templates.default.render("local_userapproval/itemenrolled_display",options)},trigger).done((function(modal){modal.setLarge(),modal.show(),modal.getRoot().on(_modal_events.default.hidden,function(){modal.destroy()}.bind(this))}))}let sendemailtouser=e.target.closest(Selectors_actions.sendemailtouser);if(sendemailtouser){e.preventDefault();const title=(0,_str.get_string)("sendemail","local_userapproval",sendemailtouser.getAttribute("data-name")),form=new _modalform.default({formClass:"local_userapproval\\form\\sendemailform",args:{id:sendemailtouser.getAttribute("data-id"),name:sendemailtouser.getAttribute("data-name"),email:sendemailtouser.getAttribute("data-email")},modalConfig:{title:title},returnFocus:sendemailtouser});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}}))}}));

//# sourceMappingURL=dynamicForm.min.js.map