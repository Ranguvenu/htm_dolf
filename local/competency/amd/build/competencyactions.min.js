define("local_competency/competencyactions",["exports","core/notification","core/pending","core/str","core/ajax","theme_academy/homepage"],(function(_exports,_notification,_pending,_str,_ajax,_homepage){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * AMD module to enable Competencies to manage their own data.
   *
   * @module     local_competency/competencyactions
   * @copyright  2022 e abyas  <info@eabyas.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=_interopRequireDefault(_notification),_pending=_interopRequireDefault(_pending),_ajax=_interopRequireDefault(_ajax),_homepage=_interopRequireDefault(_homepage);const SELECTORS_DELETE_COMPETENCY='[data-action="deletecompetency"][data-competencyid][data-competencyname]',SELECTORS_DELETE_COMPETENCYPC='[data-action="deletecompetencypc"][data-competencyid][data-competencyname]',SELECTORS_DELETE_COMPETENCYPCOBJECTIVE='[data-action="deletecompetencyobjective"][data-competencypcid][data-competencypcobjectivetype][data-competencypcobjectiveid][data-competencypcobjectivename]';let HomePage=new _homepage.default;_exports.init=()=>{document.addEventListener("click",(event=>{const triggerElement=event.target.closest(SELECTORS_DELETE_COMPETENCY);if(null===triggerElement)return;event.stopImmediatePropagation();const requiredStrings=[{key:"deletecompetency",component:"local_competency"},{key:"deletecompetencyconfirmation",component:"local_competency",param:triggerElement.dataset.competencyname}];(0,_str.get_strings)(requiredStrings).then((_ref=>{let[deleteCompetency,deleteConfirm]=_ref;return _notification.default.confirm(deleteCompetency,deleteConfirm,deleteCompetency,null,(()=>{var params={};params.elementid=triggerElement.dataset.competencyid,params.elementtype="competency",_ajax.default.call([{methodname:"local_sector_candeleteelement",args:params}])[0].done((function(resp){if(1==resp.candelete)HomePage.confirmbox((0,_str.get_string)("remove_dependency","local_sector"));else{const pendingPromise=new _pending.default,request={methodname:"local_competency_delete_data_competency",args:{competencyid:triggerElement.dataset.competencyid}};_ajax.default.call([request])[0].then((response=>(response.result?window.location.reload():_notification.default.addNotification({type:"error",message:response.warnings[0].message}),pendingPromise.resolve()))).catch(_notification.default.exception)}})).fail((function(){console.log("exception")}))}))})).catch()})),document.addEventListener("click",(event=>{const triggerElement=event.target.closest(SELECTORS_DELETE_COMPETENCYPC);if(null===triggerElement)return;event.stopImmediatePropagation();const requiredStrings=[{key:"deletecompetencypc",component:"local_competency"},{key:"deletecompetencypcconfirmation",component:"local_competency",param:triggerElement.dataset.competencyname}];(0,_str.get_strings)(requiredStrings).then((_ref2=>{let[deleteCompetencypc,deleteConfirm]=_ref2;return _notification.default.confirm(deleteCompetencypc,deleteConfirm,deleteCompetencypc,null,(()=>{const pendingPromise=new _pending.default,request={methodname:"local_competency_delete_data_competencypc",args:{competencyid:triggerElement.dataset.competencyid,competencypcid:triggerElement.dataset.id}};_ajax.default.call([request])[0].then((response=>(response.result?window.location.reload():_notification.default.addNotification({type:"error",message:response.warnings[0].message}),pendingPromise.resolve()))).catch(_notification.default.exception)}))})).catch()})),document.addEventListener("click",(event=>{const triggerElement=event.target.closest(SELECTORS_DELETE_COMPETENCYPCOBJECTIVE);if(null===triggerElement)return;event.stopImmediatePropagation();const requiredStrings=[{key:"deletecompetencypcobjective",component:"local_competency",component:"local_competency",param:triggerElement.dataset.competencypcobjectivetype},{key:"deletecompetencypcobjectiveconfirmation",component:"local_competency",param:triggerElement.dataset.competencypcobjectivename}];(0,_str.get_strings)(requiredStrings).then((_ref3=>{let[deleteCompetencypcobjective,deleteConfirm]=_ref3;return _notification.default.confirm(deleteCompetencypcobjective,deleteConfirm,deleteCompetencypcobjective,null,(()=>{const pendingPromise=new _pending.default,request={methodname:"local_competency_delete_competencypcobjectives",args:{competencypcid:triggerElement.dataset.competencypcid,competencypcobjectiveid:triggerElement.dataset.competencypcobjectiveid,competencypcobjectivetype:triggerElement.dataset.competencypcobjectivetype}};_ajax.default.call([request])[0].then((response=>(response.result?window.location.reload():_notification.default.addNotification({type:"error",message:response.warnings[0].message}),pendingPromise.resolve()))).catch(_notification.default.exception)}))})).catch()}))}}));

//# sourceMappingURL=competencyactions.min.js.map