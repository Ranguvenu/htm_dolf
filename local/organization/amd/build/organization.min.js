define("local_organization/organization",["exports","local_trainingprogram/dynamicform","core/str","core/modal_factory","core/ajax","core_form/modalform","core/modal_events","theme_academy/homepage","core/templates"],(function(_exports,_dynamicform,_str,_modal_factory,_ajax,_modalform,_modal_events,_homepage,_templates){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_dynamicform=_interopRequireDefault(_dynamicform),_modal_factory=_interopRequireDefault(_modal_factory),_ajax=_interopRequireDefault(_ajax),_modalform=_interopRequireDefault(_modalform),_modal_events=_interopRequireDefault(_modal_events),_homepage=_interopRequireDefault(_homepage),_templates=_interopRequireDefault(_templates);const Selectors_actions={createOrganization:'[data-action="createorganization"]',deleteorganization:'[data-action="deleteorganization"]',unassignuser:'[data-action="unassignuser"]',approveorganization:'[data-action="approveorganization"]',rejectorganization:'[data-action="rejectorganization"]',vieworganization:'[data-action="vieworganization"]',orgofficialassign:'[data-action="orgofficialassign"]',sendemailtohr:'[data-action="sendemailtohr"]',createpartnertypes:'[data-action="createpartnertypes"]',viewpartners:'[data-action="viewpartners"]',deletepartners:'[data-action="deletepartners"]',loginasuser:'[data-action="loginasuser"]'};let HomePage=new _homepage.default;_exports.init=()=>{document.addEventListener("click",(function(e){let sendemailtohr=e.target.closest(Selectors_actions.sendemailtohr);if(sendemailtohr){e.preventDefault();const title=(0,_str.get_string)("sendemail","local_organization"),form=new _dynamicform.default({formClass:"local_organization\\form\\hremail_form",args:{organizationid:sendemailtohr.getAttribute("data-id"),hremail:sendemailtohr.getAttribute("data-hremail")},modalConfig:{title:title},returnFocus:sendemailtohr});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let element=e.target.closest(Selectors_actions.createOrganization);if(element){e.preventDefault();const title=element.getAttribute("data-id")?(0,_str.get_string)("editorganization","local_organization",element.getAttribute("data-name")):(0,_str.get_string)("createorganization","local_organization"),form=new _dynamicform.default({formClass:"local_organization\\form\\organization_form",args:{id:element.getAttribute("data-id")},modalConfig:{title:title},returnFocus:element});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let orgofficialassign=e.target.closest(Selectors_actions.orgofficialassign);if(orgofficialassign){e.preventDefault();const title=(0,_str.get_string)("enroltoorgof","local_organization"),form=new _modalform.default({formClass:"local_organization\\form\\assignform",args:{orgid:orgofficialassign.getAttribute("data-orgid"),roleid:orgofficialassign.getAttribute("data-role")},modalConfig:{title:title},returnFocus:orgofficialassign});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let deleteorganization=e.target.closest(Selectors_actions.deleteorganization);if(deleteorganization){const organizationid=deleteorganization.getAttribute("data-id"),orgname=deleteorganization.getAttribute("data-orgname");_modal_factory.default.create({title:(0,_str.get_string)("deleteorganization","local_organization"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("deleteorgconfirm","local_organization",orgname)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("delete","local_organization")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.elementid=organizationid,params.elementtype="organization",_ajax.default.call([{methodname:"local_sector_candeleteelement",args:params}])[0].done((function(resp){if(1==resp.candelete)modal.hide(),HomePage.confirmbox((0,_str.get_string)("remove_dependency","local_sector"));else{var params={};params.organizationid=organizationid,_ajax.default.call([{methodname:"local_deleteorganization",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let unassignuser=e.target.closest(Selectors_actions.unassignuser);if(unassignuser){const id=unassignuser.getAttribute("data-id"),rolename=unassignuser.getAttribute("data-rolename"),roleid=unassignuser.getAttribute("data-roleid"),orgid=unassignuser.getAttribute("data-orgid"),username=unassignuser.getAttribute("data-username"),orgname=unassignuser.getAttribute("data-orgname");var displayparams={};displayparams.rolename=rolename,displayparams.username=username,displayparams.orgname=orgname,_modal_factory.default.create({title:(0,_str.get_string)("unassignconfirm","local_organization"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("orgunassignconfirm","local_organization",displayparams)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("unassigntext","local_organization")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.id=id,params.roleid=roleid,params.orgid=orgid,_ajax.default.call([{methodname:"local_deleteorguser",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let approveorganization=e.target.closest(Selectors_actions.approveorganization);if(approveorganization){const orgid=approveorganization.getAttribute("data-id");_modal_factory.default.create({title:(0,_str.get_string)("approveorganization","local_organization"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("approveallconfirm","local_organization")}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("approve","local_organization")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.orgid=orgid,_ajax.default.call([{methodname:"local_approve_organization",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let rejectorganization=e.target.closest(Selectors_actions.rejectorganization);if(rejectorganization){const orgid=rejectorganization.getAttribute("data-id");_modal_factory.default.create({title:(0,_str.get_string)("rejectorganization","local_organization"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("rejectallconfirm","local_organization")}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("reject","local_organization")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.orgid=orgid,_ajax.default.call([{methodname:"local_reject_organization",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let vieworganization=e.target.closest(Selectors_actions.vieworganization);if(vieworganization){const orgid=vieworganization.getAttribute("data-id");(params={}).orgid=orgid,_ajax.default.call([{methodname:"local_organization_info",args:params}])[0].done((function(resp){JSON.stringify(resp);_modal_factory.default.create({title:(0,_str.get_string)("vieworganization","local_organization"),body:resp.options}).done(function(modal){this.modal=modal,this.modal.setLarge(),modal.show()}.bind(this))})).fail((function(){console.log("exception")}))}let createpartnertypes=e.target.closest(Selectors_actions.createpartnertypes);if(createpartnertypes){e.preventDefault();const title=createpartnertypes.getAttribute("data-id")?(0,_str.get_string)("edittypes","local_organization"):(0,_str.get_string)("createpartner","local_organization"),form=new _dynamicform.default({formClass:"local_organization\\form\\partnertypes_form",args:{id:createpartnertypes.getAttribute("data-id")},modalConfig:{title:title},returnFocus:createpartnertypes});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let viewpartners=e.target.closest(Selectors_actions.viewpartners);if(viewpartners){const partnerid=viewpartners.getAttribute("data-id");var params;(params={}).partnerid=partnerid,_ajax.default.call([{methodname:"viewpartnertypes",args:params}])[0].done((function(resp){_modal_factory.default.create({title:(0,_str.get_string)("viewtypes","local_organization"),body:resp.partnerinfo}).done(function(modal){this.modal=modal,modal.show(),modal.setLarge()}.bind(this))})).fail((function(){console.log("exception")}))}let deletepartners=e.target.closest(Selectors_actions.deletepartners);if(deletepartners){const partnerid=deletepartners.getAttribute("data-id"),partnername=deletepartners.getAttribute("data-partnername");_modal_factory.default.create({title:(0,_str.get_string)("deletetype","local_organization"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("deletepartnerconfirm","local_organization",partnername)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("delete","local_organization")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.partnerid=partnerid,_ajax.default.call([{methodname:"deletepartnertypes",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let loginasuser=e.target.closest(Selectors_actions.loginasuser);if(loginasuser){e.preventDefault(),e.stopImmediatePropagation();const title=(0,_str.get_string)("loginasuser","local_userapproval"),form=new _dynamicform.default({formClass:"local_userapproval\\form\\userloginas_form",args:{userid:loginasuser.getAttribute("data-userid"),localuserid:loginasuser.getAttribute("data-localuserid")},modalConfig:{title:title},returnFocus:loginasuser});form.addEventListener(form.events.FORM_SUBMITTED,(event=>{const data=event.detail;"success"==data.response?window.location.href=data.returnurl:HomePage.confirmbox(data.response)})),form.show()}}))}}));

//# sourceMappingURL=organization.min.js.map