{"version":3,"file":"programmethods.min.js","sources":["../src/programmethods.js"],"sourcesContent":["import TPDynamicForm from 'local_trainingprogram/dynamicform';\nimport ModalForm from 'core_form/modalform';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport Ajax from 'core/ajax';\nimport {get_string as getString} from 'core/str';\nconst Selectors = {\n    actions: {\n        createprogrammethod: '[data-action=\"createprogrammethod\"]',\n        deleteprogrammethod: '[data-action=\"deleteprogrammethod\"]',\n        \n    },\n};\nexport const init = () => {\n    document.addEventListener('click', function(e) {\n       // e.stopImmediatePropagation()\n        let element = e.target.closest(Selectors.actions.createprogrammethod);\n        if (element) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            const title = element.getAttribute('data-id') ?\n                getString('editprogrammethod', 'local_trainingprogram') :\n                getString('createprogrammethod', 'local_trainingprogram');\n            const form = new TPDynamicForm({\n                formClass: 'local_trainingprogram\\\\form\\\\programmethod_form',\n                args: {id: element.getAttribute('data-id')},\n                modalConfig: {title},\n                returnFocus: element,\n            });\n            form.addEventListener(form.events.FORM_SUBMITTED, () => window.location.reload());\n            form.show();\n        }\n\n        let deleteprogram = e.target.closest(Selectors.actions.deleteprogrammethod);\n        if (deleteprogram) {\n             e.preventDefault();\n             e.stopImmediatePropagation();\n             const id = deleteprogram.getAttribute('data-id');\n             const pname= deleteprogram.getAttribute('data-name');\n             \n             var displayparams = {};\n             displayparams.id = id;\n             displayparams.pname = pname;\n            ModalFactory.create({\n                title: getString('deleteconfirm', 'local_trainingprogram'),\n                type: ModalFactory.types.SAVE_CANCEL,\n                body: getString('deleteprogrammessage', 'local_trainingprogram',displayparams)\n            }).done(function(modal) {\n                this.modal = modal;\n                modal.setSaveButtonText(getString('deletetext', 'local_trainingprogram'));\n                modal.getRoot().on(ModalEvents.save, function(e) {\n                    e.preventDefault();\n                    var params = {};\n                    params.id = id;\n                    var promise = Ajax.call([{\n                        methodname: 'local_trainingprogram_deleteprogrammethod',\n                        args: params\n                    }]);\n                    promise[0].done(function(resp) {\n                        window.location.reload(true);\n                    }).fail(function() {\n                        console.log('exception');\n                    });\n                }.bind(this));\n                modal.show();\n            }.bind(this));\n        }\n      \n    });\n};\n"],"names":["Selectors","createprogrammethod","deleteprogrammethod","document","addEventListener","e","element","target","closest","preventDefault","stopImmediatePropagation","title","getAttribute","form","TPDynamicForm","formClass","args","id","modalConfig","returnFocus","events","FORM_SUBMITTED","window","location","reload","show","deleteprogram","pname","displayparams","create","type","ModalFactory","types","SAVE_CANCEL","body","done","modal","setSaveButtonText","getRoot","on","ModalEvents","save","params","Ajax","call","methodname","resp","fail","console","log","bind","this"],"mappings":"ypBAMMA,kBACO,CACLC,oBAAqB,sCACrBC,oBAAqB,qDAIT,WAChBC,SAASC,iBAAiB,SAAS,SAASC,OAEpCC,QAAUD,EAAEE,OAAOC,QAAQR,kBAAkBC,wBAC7CK,QAAS,CACTD,EAAEI,iBACFJ,EAAEK,+BACIC,MAAQL,QAAQM,aAAa,YAC/B,mBAAU,oBAAqB,0BAC/B,mBAAU,sBAAuB,yBAC/BC,KAAO,IAAIC,qBAAc,CAC3BC,UAAW,kDACXC,KAAM,CAACC,GAAIX,QAAQM,aAAa,YAChCM,YAAa,CAACP,MAAAA,OACdQ,YAAab,UAEjBO,KAAKT,iBAAiBS,KAAKO,OAAOC,gBAAgB,kBAAMC,OAAOC,SAASC,YACxEX,KAAKY,WAGLC,cAAgBrB,EAAEE,OAAOC,QAAQR,kBAAkBE,wBACnDwB,cAAe,CACdrB,EAAEI,iBACFJ,EAAEK,+BACIO,GAAKS,cAAcd,aAAa,WAChCe,MAAOD,cAAcd,aAAa,aAEpCgB,cAAgB,GACpBA,cAAcX,GAAKA,GACnBW,cAAcD,MAAQA,6BACVE,OAAO,CAChBlB,OAAO,mBAAU,gBAAiB,yBAClCmB,KAAMC,uBAAaC,MAAMC,YACzBC,MAAM,mBAAU,uBAAwB,wBAAwBN,iBACjEO,KAAK,SAASC,YACRA,MAAQA,MACbA,MAAMC,mBAAkB,mBAAU,aAAc,0BAChDD,MAAME,UAAUC,GAAGC,sBAAYC,KAAM,SAASpC,GAC1CA,EAAEI,qBACEiC,OAAS,GACbA,OAAOzB,GAAKA,GACE0B,cAAKC,KAAK,CAAC,CACrBC,WAAY,4CACZ7B,KAAM0B,UAEF,GAAGP,MAAK,SAASW,MACrBxB,OAAOC,SAASC,QAAO,MACxBuB,MAAK,WACJC,QAAQC,IAAI,iBAElBC,KAAKC,OACPf,MAAMX,QACRyB,KAAKC"}