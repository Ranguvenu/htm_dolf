function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}define("local_trainingprogram/dynamicform",["exports","core_form/modalform","core/pending","core/modal_factory","core/modal_events","core/notification","core/ajax","core/str"],(function(_exports,_modalform,_pending,_modal_factory,_modal_events,_notification,_ajax,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(self)}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_modalform=_interopRequireDefault(_modalform),_pending=_interopRequireDefault(_pending),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_notification=_interopRequireDefault(_notification),_ajax=_interopRequireDefault(_ajax);var TPDynamicForm=function(_ModalForm){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(TPDynamicForm,_ModalForm);var Constructor,protoProps,staticProps,_super=_createSuper(TPDynamicForm);function TPDynamicForm(){var _this;_classCallCheck(this,TPDynamicForm);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _defineProperty(_assertThisInitialized(_this=_super.call.apply(_super,[this].concat(args))),"events",{FORM_SUBMITTED:"core_form_modalform_formsubmitted",FORM_CANCELLED:"core_form_modalform_formcancelled",CLIENT_VALIDATION_ERROR:"core_form_modalform_clientvalidationerror",SERVER_VALIDATION_ERROR:"core_form_modalform_validationerror",ERROR:"core_form_modalform_error",NOSUBMIT_BUTTON_PRESSED:"core_form_modalform_nosubmitbutton",SUBMIT_BUTTON_PRESSED:"core_form_modalform_submitbutton",CANCEL_BUTTON_PRESSED:"core_form_modalform_cancelbutton",LOADED:"core_form_modalform_loaded",CONTENT_LOADED:"local_trainingprogram_dynamicform_content_loaded"}),_this}return Constructor=TPDynamicForm,(protoProps=[{key:"show",value:function(){var _this2=this,pendingPromise=new _pending.default("core_form/modalform:init");return _modal_factory.default.create(this.config.modalConfig).then((function(modal){_this2.modal=modal;var formParams=new URLSearchParams(Object.entries(_this2.config.args||{}));_this2.modal.setLarge(),_this2.modal.getRoot().addClass("openLMStransition"),_this2.modal.getRoot().on(_modal_events.default.hidden,function(){this.modal.getRoot().animate({right:"-85%"},500),setTimeout((function(){this.modal.destroy()}),1e3),this.modal.setBody("")}.bind(_this2)),_this2.modal.getRoot().animate({right:"0%"},500),_this2.modal.getFooter().find('[data-action="cancel"]').on("click",(function(){this.modal.setBody(""),this.modal.hide(),setTimeout((function(){this.modal.destroy()}),1e3)})),_this2.modal.getRoot().find('[data-action="hide"]').on("click",(function(){this.modal.hide(),setTimeout((function(){this.modal.destroy()}),1e3),this.modal.destroy()}));var bodyContent=_this2.getBody(formParams.toString());return _this2.modal.setBodyContent(bodyContent),_this2.modal.getRoot().on(_modal_events.default.bodyRendered,(function(e){_this2.trigger(_this2.events.CONTENT_LOADED);var sectors=$("select[name='sectors[]']").val();void 0!==$("#el_segmentlist")&&$("select#el_segmentlist").data("sectorid",sectors),void 0!==$("#el_jobfamily")&&$("#el_jobfamily").data("sectorid",sectors),$("select[name='sectors[]']").on("change",(function(e){var sectors=$(this).val(),segments=$(this).closest("form").find("select[name='segments[]']");segments.val(""),segments.attr("data-sectorid",sectors);var targetgroup=$(this).closest("form").find("select[name='targetgroup[]']");targetgroup.val(""),targetgroup.attr("data-sectorid",sectors)})),sectors=$("select[name='sectors']").val(),void 0!==$("#el_segmentlist")&&$("select#el_segmentlist").attr("data-sectorid",sectors),void 0!==$("#el_jobfamily")&&$("#el_jobfamily").attr("data-sectorid",sectors),$("select[name='sectors']").on("change",(function(e){var sectors=$(this).val(),segments=$(this).closest("form").find("select[name='segments[]']"),segment=$(this).closest("form").find("select[name='segment']");segments.val(""),segments.attr("data-sectorid",sectors),segment.val(""),segment.attr("data-sectorid",sectors);var targetgroup=$(this).closest("form").find("select[name='targetgroup[]']");targetgroup.val(""),targetgroup.attr("data-sectorid",sectors)}));var ctype=$("select[name='ctype[]']").val();if(void 0!==$("#el_competencieslist")&&$("select#el_competencieslist").data("ctype",ctype),void 0!==$("#el_segmentlist")&&void 0!==$("#el_jobfamily")){sectors=$(".el_sectorlist").val(),$("select#el_jobfamily").attr("data-sectorid",sectors);var segments=$("#el_segmentlist").val();$("select#el_jobfamily").attr("data-segmentid",segments)}if($("#el_segmentlist").on("change",(function(e){var segments=$("#el_segmentlist").val();$("select#el_jobfamily").val(""),$("select#el_jobfamily").attr("data-segmentid",segments)})),void 0!==$("#el_jobfamily")&&void 0!==$("#el_jobroles")){var jobfamily=$("#el_jobfamily").val();$("select#el_jobroles").attr("data-jobfamilyid",jobfamily)}$("#el_jobfamily").on("change",(function(e){var jobfamily=$("#el_jobfamily").val();$("select#el_jobroles").val(""),$("select#el_jobroles").attr("data-jobfamilyid",jobfamily)})),$("select[name='startdate[day]']").on("change",(function(e){$(".entityhall .badge-info").html(""),(0,_str.get_strings)([{key:"selecthall",component:"local_trainingprogram"}]).then((function(_ref){var title=_slicedToArray(_ref,1)[0];$(".entityhall .badge-info").html(title)})).catch(),$("select[name='halladdress']").val("0");var params={};params.sessionkey=$("input[name='sesskey']").val(),params.type="tprogram",_ajax.default.call([{methodname:"remove_reservations",args:params}])[0].done((function(resp){$(".entityhalldetails").html(""),console.log("Successfully reservations removed")})).fail((function(){console.log("exception")}))}))})),bodyContent.catch(_notification.default.exception),_this2.modal.getRoot().on(_modal_events.default.hidden,(function(){_this2.notifyResetFormChanges(),_this2.modal.destroy(),_this2.config.returnFocus&&_this2.config.returnFocus.focus()})),_this2.modal.getModal().addClass("modal-form-dialogue"),_this2.modal.getRoot().on("click","form input[type=submit][data-no-submit]",(function(e){e.preventDefault(),_this2.trigger(_this2.events.NOSUBMIT_BUTTON_PRESSED,e.target).defaultPrevented||_this2.processNoSubmitButton(e.target)})),_this2.modal.getRoot().on("submit","form",(function(e){e.preventDefault(),_this2.trigger(_this2.events.SUBMIT_BUTTON_PRESSED).defaultPrevented||_this2.submitFormAjax()})),void 0!==_this2.config.saveButtonText&&void 0!==_this2.modal.setSaveButtonText&&_this2.modal.setSaveButtonText(_this2.config.saveButtonText),void 0!==_this2.config.saveButtonClasses&&_this2.setSaveButtonClasses(_this2.config.saveButtonClasses),_this2.modal.getRoot().on(_modal_events.default.save,(function(e){e.preventDefault(),_this2.modal.getRoot().find("form").submit()})),_this2.modal.getRoot().on(_modal_events.default.cancel,(function(e){_this2.trigger(_this2.events.CANCEL_BUTTON_PRESSED).defaultPrevented&&e.preventDefault()})),_this2.futureListeners.forEach((function(args){var _this2$modal$getRoot$;return(_this2$modal$getRoot$=_this2.modal.getRoot()[0]).addEventListener.apply(_this2$modal$getRoot$,_toConsumableArray(args))})),_this2.futureListeners=[],_this2.trigger(_this2.events.LOADED,null,!1),_this2.modal.show()})).then(pendingPromise.resolve)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),TPDynamicForm}(_modalform.default);return _exports.default=TPDynamicForm,_exports.default}));

//# sourceMappingURL=dynamicform.min.js.map