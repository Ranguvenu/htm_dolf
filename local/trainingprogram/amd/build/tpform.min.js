define("local_trainingprogram/tpform",["exports","local_trainingprogram/dynamicform","core/str","core/modal_factory","core/ajax","core_form/modalform","core/modal_events","core/templates","theme_academy/homepage"],(function(_exports,_dynamicform,_str,_modal_factory,_ajax,_modalform,_modal_events,_templates,_homepage){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * TODO describe module tpform
   *
   * @module     local_trainingprogram/tpform
   * @copyright  2023 YOUR NAME <your@email.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_dynamicform=_interopRequireDefault(_dynamicform),_modal_factory=_interopRequireDefault(_modal_factory),_ajax=_interopRequireDefault(_ajax),_modalform=_interopRequireDefault(_modalform),_modal_events=_interopRequireDefault(_modal_events),_templates=_interopRequireDefault(_templates),_homepage=_interopRequireDefault(_homepage);var Selectors_actions={editCategory:'[data-action="createprogram"]',deleteprogram:'[data-action="deleteprogram"]',publichprogram:'[data-action="publichprogram"]',trainerassign:'[data-action="trainerassign"]',unassignuser:'[data-action="unassignuser"]',createtrainingtopics:'[data-action="createtrainingtopics"]',deletetrainingtopics:'[data-action="deletetrainingtopics"]',createprogramgoal:'[data-action="createprogramgoal"]',unpublichprogram:'[data-action="unpublichprogram"]'};require(["jquery"],(function($){$(document).ready((function(){$("body").on("change",'input[name="tporoff"]',(function(){2==$("input[name='tporoff']:checked").val()?($('input[type=radio][name="startdatesort"][value=3]').prop("disabled",!0),$('input[type=radio][name="startdatesort"][value=4]').prop("disabled",!0)):($('input[type=radio][name="startdatesort"][value=3]').prop("disabled",!1),$('input[type=radio][name="startdatesort"][value=4]').prop("disabled",!1))}))}))}));var HomePage=new _homepage.default;_exports.init=function(){document.addEventListener("click",(function(e){var element=e.target.closest(Selectors_actions.editCategory);if(element){e.preventDefault(),e.stopImmediatePropagation();var title=element.getAttribute("data-id")?(0,_str.get_string)("updatetp","local_trainingprogram"):(0,_str.get_string)("createtp","local_trainingprogram"),form=new _dynamicform.default({formClass:"local_trainingprogram\\form\\trainingprogram",args:{id:element.getAttribute("data-id"),courseid:element.getAttribute("data-courseid")},modalConfig:{title:title},returnFocus:element});form.addEventListener(form.events.FORM_SUBMITTED,(function(){return window.location.reload()})),form.show()}var deleteprogram=e.target.closest(Selectors_actions.deleteprogram);if(deleteprogram){e.preventDefault();var programid=deleteprogram.getAttribute("data-id"),programname=deleteprogram.getAttribute("data-name"),programcode=deleteprogram.getAttribute("data-code"),userroleshortname=deleteprogram.getAttribute("data-userroleshortname");(displayparams={}).programname=programname,displayparams.programcode=programcode,_modal_factory.default.create({title:(0,_str.get_string)("deleteconfirm","local_trainingprogram"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("programdeleteconfirm","local_trainingprogram",programname)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("deletetext","local_trainingprogram")),modal.getRoot().on(_modal_events.default.save,function(e){var params;(e.preventDefault(),"to"==userroleshortname)?((params={}).rootid=programid,params.etype="program",_ajax.default.call([{methodname:"local_trainingprogram_tofficialdeleteaction",args:params}])[0].done((function(resp){"success"==resp.response?(modal.hide(),HomePage.confirmbox((0,_str.get_string)("programdeletionwaitingfortsuperviser","local_trainingprogram",displayparams)),setTimeout((function(){location.reload()}),4e3)):(modal.hide(),HomePage.confirmbox(resp.response))})).fail((function(){console.log("exception")}))):((params={}).programid=programid,_ajax.default.call([{methodname:"local_trainingprogram_deleteprogram",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")})))}.bind(this)),modal.show()}.bind(this))}var publichprogram=e.target.closest(Selectors_actions.publichprogram);if(publichprogram){e.preventDefault();var _programid=publichprogram.getAttribute("data-id"),_programname=publichprogram.getAttribute("data-name");_modal_factory.default.create({title:(0,_str.get_string)("publishconfirm","local_trainingprogram"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("programpublishconfirm","local_trainingprogram",_programname)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("publishtext","local_trainingprogram")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.programid=_programid,_ajax.default.call([{methodname:"local_trainingprogram_publishprogram",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}var unpublichprogram=e.target.closest(Selectors_actions.unpublichprogram);if(unpublichprogram){e.preventDefault();var _programid2=unpublichprogram.getAttribute("data-id"),_programname2=unpublichprogram.getAttribute("data-name");_modal_factory.default.create({title:(0,_str.get_string)("unpublishconfirm","local_trainingprogram"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("programunpublishconfirm","local_trainingprogram",_programname2)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("unpublishtext","local_trainingprogram")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.programid=_programid2,_ajax.default.call([{methodname:"local_trainingprogram_unpublishprogram",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}var trainerassign=e.target.closest(Selectors_actions.trainerassign);if(trainerassign){e.preventDefault();var _programname3=trainerassign.getAttribute("data-programname"),_title=(0,_str.get_string)("enroltoprogram","local_trainingprogram",_programname3),_form=new _modalform.default({formClass:"local_trainingprogram\\form\\trainerassignform",args:{programid:trainerassign.getAttribute("data-programid"),offeringid:trainerassign.getAttribute("data-offeringid"),roleid:trainerassign.getAttribute("data-role")},modalConfig:{title:_title},returnFocus:trainerassign});_form.addEventListener(_form.events.FORM_SUBMITTED,(function(){return window.location.reload()})),_form.show()}var unassignuser=e.target.closest(Selectors_actions.unassignuser);if(unassignuser){e.preventDefault();var displayparams,userid=unassignuser.getAttribute("data-id"),_programid3=unassignuser.getAttribute("data-programid"),roleid=unassignuser.getAttribute("data-roleid"),offeringid=unassignuser.getAttribute("data-offeringid"),rolename=unassignuser.getAttribute("data-rolename"),username=unassignuser.getAttribute("data-username"),coursename=unassignuser.getAttribute("data-coursename");(displayparams={}).rolename=rolename,displayparams.username=username,displayparams.coursename=coursename,_modal_factory.default.create({title:(0,_str.get_string)("unassignconfirm","local_trainingprogram"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("programunassignconfirm","local_trainingprogram",displayparams)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("unassigntext","local_trainingprogram")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.userid=userid,params.programid=_programid3,params.offeringid=offeringid,params.roleid=roleid,_ajax.default.call([{methodname:"local_trainingprogram_unassignuser",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}var createtrainingtopicselement=e.target.closest(Selectors_actions.createtrainingtopics);if(createtrainingtopicselement){e.preventDefault();var _title2=createtrainingtopicselement.getAttribute("data-id")?(0,_str.get_string)("updatetrainingtopic","local_trainingprogram"):(0,_str.get_string)("createtrainingtopic","local_trainingprogram"),_form2=new _dynamicform.default({formClass:"local_trainingprogram\\form\\trainingtopicsform",args:{id:createtrainingtopicselement.getAttribute("data-id")},modalConfig:{title:_title2},returnFocus:createtrainingtopicselement});_form2.addEventListener(_form2.events.FORM_SUBMITTED,(function(){return window.location.reload()})),_form2.show()}var deletetrainingtopics=e.target.closest(Selectors_actions.deletetrainingtopics);if(deletetrainingtopics){e.preventDefault();var id=deletetrainingtopics.getAttribute("data-id"),name=deletetrainingtopics.getAttribute("data-name");_modal_factory.default.create({title:(0,_str.get_string)("deleteconfirm","local_trainingprogram"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("trainingtopicdeleteconfirm","local_trainingprogram",name)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("deletetext","local_trainingprogram")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.elementid=id,params.elementtype="trainingtopic",_ajax.default.call([{methodname:"local_sector_candeleteelement",args:params}])[0].done((function(resp){if(1==resp.candelete)modal.hide(),HomePage.confirmbox((0,_str.get_string)("remove_dependency","local_sector"));else{var params={};params.id=id,_ajax.default.call([{methodname:"local_trainingprogram_deletetrainingtopic",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}if(createprogramgoal=e.target.closest(Selectors_actions.createprogramgoal),createprogramgoal){e.preventDefault();var _title3=createprogramgoal.getAttribute("data-id")?(0,_str.get_string)("updategoals","local_trainingprogram",createprogramgoal.getAttribute("data-name")):(0,_str.get_string)("addprogramgoal","local_trainingprogram"),_form3=new _modalform.default({formClass:"local_trainingprogram\\form\\programgoalsform",args:{id:createprogramgoal.getAttribute("data-id"),programid:createprogramgoal.getAttribute("data-programid")},modalConfig:{title:_title3},returnFocus:createprogramgoal});_form3.addEventListener(_form3.events.FORM_SUBMITTED,(function(){return window.location.reload()})),_form3.show()}}))}}));

//# sourceMappingURL=tpform.min.js.map