/**
 * TODO describe module dynamic_dropdown_ajaxdata
 *
 * @module     local_trainingprogram/dynamic_dropdown_ajaxdata
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_trainingprogram/dynamic_dropdown_ajaxdata",["jquery","core/ajax","core/notification","core/str"],(function($,Ajax,Notification,Str){return{processResults:function(selector,results){var options=[];return $.each(results.data,(function(index,response){options.push({value:response.id,label:response.fullname})})),options},transport:function(selector,query,callback){var el=$(selector),ctype=0;switch(programid=0,offeringid=0,type=el.data("type"),levels=0,sectors=0,type){case"program_competencylevel":if(void 0===$("select[name='ctype[]']").val())ctype=el.attr("data-ctype"),levels=$("select[name='clevels']").val();else{ctype=$("select[name='ctype[]']  option:selected").map((function(){return $(this).val()})).get().join(",");levels=$("select[name='clevels']").val()}ctype=JSON.stringify(ctype),programid=el.data("programid"),offeringid=el.data("offeringid"),sectors=sectors,levels=levels;break;case"programusers":case"officials":case"loginasusers":case"allentities":ctype=el.data("ctype"),programid=el.data("programid"),offeringid=el.data("offeringid");break;case"orgofficial":ctype=el.data("ctype"),programid=$("select[name='organization']").val(),offeringid=el.data("offeringid");break;case"program_competency":$("select[name='clevels']").val(),levels=$("select[name='clevels']").val(),levels=levels}console.log(programid),Ajax.call([{methodname:"local_trainingprogram_ajaxdatalist",args:{query:query,type:type,ctype:ctype,programid:programid,offeringid:offeringid,sectors:sectors,level:levels}}])[0].then(callback).catch(Notification.exception)},organizationchanged:function(){$("select[name='orgofficial'] option:selected").prop("selected",!1),$("select[name='orgofficial']").parent().find(".badge-info").html("")},sectorschanged:function(){$("select[name='segment'] option:selected").prop("selected",!1),$("select[name='segment']").parent().find(".badge-info").html(""),$("select[name='segment[]'] option:selected").prop("selected",!1),$("select[name='segment[]']").parent().find(".badge-info").html(""),$("select[name='targetgroup[]'] option:selected").prop("selected",!1),$("select[name='targetgroup[]']").parent().find(".badge-info").html(""),Str.get_string("segment","local_trainingprogram").then((function(title){$("select[name='segment']").parent().find(".badge-info").html(title)})),$("select[name='jobfamily'] option:selected").prop("selected",!1),$("select[name='jobfamily']").parent().find(".badge-info").html(""),Str.get_string("jobfamily","local_trainingprogram").then((function(title){$("select[name='jobfamily']").parent().find(".badge-info").html(title)})),$("select[name='jobrole'] option:selected").prop("selected",!1),$("select[name='jobrole']").parent().find(".badge-info").html(""),Str.get_string("jobrole","local_trainingprogram").then((function(title){$("select[name='jobrole']").parent().find(".badge-info").html(title)})),$("select[name='segments[]'] option:selected").prop("selected",!1),$("select[name='segments[]']").parent().find(".badge-info").html(""),$("input[name='alltargetgroup").prop("checked",!1);var selectedSector,dropdown=document.getElementById("program_sectors");if(dropdown)for(var i=0;i<dropdown.options.length;i++)dropdown.options[i].selected&&(selectedSector=dropdown.options[i].value,document.querySelector(".newjobfamilyoptions_"+selectedSector)||Ajax.call([{methodname:"local_trainingprogram_newjobfamily_options",args:{sector_id:selectedSector}}])[0].done((function(resp){$(".newjobfamilyoption").append(resp.str)})).fail((function(exception){console.log(exception)})))},clevels:function(){$("select[name='ctype[]'] option:selected").prop("selected",!1),$("select[name='ctype[]']").parent().find(".badge-info").html(""),$("select[name='competencylevel[]'] option:selected").prop("selected",!1),$("select[name='competencylevel[]']").parent().find(".badge-info").html("")},ctype:function(){var level=$("select[name='clevels']").val(),competencies=$("select[name='competencylevel[]']").find("option").map((function(){return this.value})).get().join(","),ctypes=$("select[name='ctype[]']").map((function(){return $(this).val()})).get().join(",");Ajax.call([{methodname:"local_trainingprogram_competencies",args:{level:level,ctypes:ctypes,competencies:competencies}}])[0].done((function(resp){resp.forEach((function(item,index){$("select[name='competencylevel[]'] option[value='"+item.id+"']").prop("selected",!1),$("select[name='competencylevel[]']").parent().find(".form-autocomplete-selection").find('span[data-value="'+item.id+'"]').remove()}))})).fail((function(){console.log("exception")}))},segmentschanged:function(){$("select[name='jobfamily'] option:selected").prop("selected",!1),$("select[name='jobfamily']").parent().find(".badge-info").html(""),Str.get_string("jobfamily","local_trainingprogram").then((function(title){$("select[name='jobfamily']").parent().find(".badge-info").html(title)})),$("select[name='jobrole'] option:selected").prop("selected",!1),$("select[name='jobrole']").parent().find(".badge-info").html(""),Str.get_string("jobrole","local_trainingprogram").then((function(title){$("select[name='jobrole']").parent().find(".badge-info").html(title)}))},jfamilychanged:function(){$("select[name='jobrole'] option:selected").prop("selected",!1),$("select[name='jobrole']").parent().find(".badge-info").html(""),Str.get_string("jobrole","local_trainingprogram").then((function(title){$("select[name='jobrole']").parent().find(".badge-info").html(title)}))}}}));

//# sourceMappingURL=dynamic_dropdown_ajaxdata.min.js.map