define("local_cpd/cpdform",["exports","core_form/modalform","core/modal_factory","core/modal_events","core/ajax","core/notification","theme_academy/homepage","core/str"],(function(_exports,_modalform,_modal_factory,_modal_events,_ajax,_notification,_homepage,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modalform=_interopRequireDefault(_modalform),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification),_homepage=_interopRequireDefault(_homepage),require(["jquery"],(function($){$(document).ready((function(){$("body").on("change",'input[name="evidencetype"]',(function(){var selected_type=$(this).val();$(".tagscontainer").addClass("invisible1"),1==selected_type&&$('.tagscontainer[data-tagtype="1"]').removeClass("invisible1"),2==selected_type&&$('.tagscontainer[data-tagtype="2"]').removeClass("invisible1")}))}))}));const Selectors_actions={editCategory:'[data-action="createcpd"]',deletecpd:'[data-action="deletecpd"]',createformalevid:'[data-action="createformalevid"]',createinformalevid:'[data-action = "createinformalevid"]',createevidence:'[data-action = "createevidence"]',evidencestatus:'[data-action = "evidencestatus"]',evidenceuserview:'[data-action = "evidenceuserview"]',viewevidence:'[data-action = "viewevidence"]',deleteevidence:'[data-action = "deleteevidence"]',edittrainigprogram:'[data-action = "edittrainigprogram"]',deletetrainigprogram:'[data-action = "deletetrainigprogram"]',evidence_rejectstatus:'[data-action = "evidence_rejectstatus"]'};_exports.init=()=>{document.addEventListener("click",(function(e){e.stopImmediatePropagation();let rejectstatus=e.target.closest(Selectors_actions.evidence_rejectstatus);if(rejectstatus){e.preventDefault();const title=(0,_str.get_string)("rejectionreason","local_cpd"),form=new _modalform.default({formClass:"local_cpd\\form\\evidence_rejection_form",args:{evedid:rejectstatus.getAttribute("data-id")},modalConfig:{title:title},returnFocus:rejectstatus});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let element=e.target.closest(Selectors_actions.editCategory);if(element){e.preventDefault();const title=element.getAttribute("data-id")?(0,_str.get_string)("editcpd","local_cpd",element.getAttribute("data-name")):(0,_str.get_string)("addnewcpd","local_cpd"),form=new _modalform.default({formClass:"local_cpd\\form\\form",args:{id:element.getAttribute("data-id")},modalConfig:{title:title},returnFocus:element});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let deleteelement=e.target.closest(Selectors_actions.deletecpd);if(deleteelement){const cpdid=deleteelement.getAttribute("data-id"),cpname=deleteelement.getAttribute("data-name");_modal_factory.default.create({title:(0,_str.get_string)("delete","local_cpd"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("deleteconfirm","local_cpd",cpname)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("delete_cpd","local_cpd")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={confirm:!0};params.cpdid=cpdid,_ajax.default.call([{methodname:"local_cpd_deletecpd",args:params}])[0].done((function(){window.location.reload(!0)})).fail((function(){}))}.bind(this)),modal.show()}.bind(this))}let formalelement=e.target.closest(Selectors_actions.createformalevid);if(formalelement){e.preventDefault();const title=(0,_str.get_string)("formaltraining","local_cpd",formalelement.getAttribute("data-typename")),form=new _modalform.default({formClass:"local_cpd\\form\\formaltrainingform",args:{id:formalelement.getAttribute("data-id"),cpdid:formalelement.getAttribute("data-cpdid"),evidid:formalelement.getAttribute("data-evidid"),type:formalelement.getAttribute("data-type")},modalConfig:{title:title},returnFocus:formalelement});form.addEventListener(form.events.FORM_SUBMITTED,(e=>{const args=formalelement.getAttribute("data-typename");(new _homepage.default).confirmbox((0,_str.get_string)("learninginfosuccess","local_cpd",args))})),form.show()}let informalelement=e.target.closest(Selectors_actions.createinformalevid);if(informalelement){e.preventDefault();const title=(0,_str.get_string)("informaltraining","local_cpd",informalelement.getAttribute("data-typename")),form=new _modalform.default({formClass:"local_cpd\\form\\informaltrainingform",args:{id:informalelement.getAttribute("data-id"),cpdid:informalelement.getAttribute("data-cpdid"),evidid:informalelement.getAttribute("data-evidid"),type:informalelement.getAttribute("data-type")},modalConfig:{title:title},returnFocus:informalelement});form.addEventListener(form.events.FORM_SUBMITTED,(e=>{const args=informalelement.getAttribute("data-typename");(new _homepage.default).confirmbox((0,_str.get_string)("learninginfosuccess","local_cpd",args))})),form.show()}let evidence=e.target.closest(Selectors_actions.createevidence);if(evidence){e.preventDefault();const title=evidence.getAttribute("data-id")?(0,_str.get_string)("editevidence","local_cpd",evidence.getAttribute("data-name")):(0,_str.get_string)("addevidence","local_cpd"),form=new _modalform.default({formClass:"local_cpd\\form\\evidenceform",args:{id:evidence.getAttribute("data-id")},modalConfig:{title:title},returnFocus:evidence});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let evidencestatus=e.target.closest(Selectors_actions.evidencestatus);if(evidencestatus){const evalid=evidencestatus.getAttribute("data-id"),header=evidencestatus.getAttribute("data-title"),status=evidencestatus.getAttribute("data-status"),creditedhours=evidencestatus.getAttribute("data-creditedhours");if("1"==status)var confirm_msg=(0,_str.get_string)("approveconfirm","local_cpd"),buttonstring=(0,_str.get_string)(header,"local_cpd");else confirm_msg=(0,_str.get_string)("rejectconfirm","local_cpd"),buttonstring=(0,_str.get_string)(header,"local_cpd");_modal_factory.default.create({title:(0,_str.get_string)(header,"local_cpd"),type:_modal_factory.default.types.SAVE_CANCEL,body:confirm_msg}).done(function(modal){this.modal=modal,modal.setSaveButtonText(buttonstring),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={confirm:!0};params.evalid=evalid,params.status=status,params.creditedhours=creditedhours,_ajax.default.call([{methodname:"local_cpd_evidencestatus",args:params}])[0].done((function(){window.location.reload(!0)})).fail((function(){}))}.bind(this)),modal.show()}.bind(this))}let evidenceuserview=e.target.closest(Selectors_actions.evidenceuserview);if(evidenceuserview){const ceid=evidenceuserview.getAttribute("data-id"),userid=evidenceuserview.getAttribute("data-userid"),evdtype=evidenceuserview.getAttribute("data-type");(params={}).ceid=ceid,params.userid=userid,params.evdtype=evdtype,_ajax.default.call([{methodname:"local_cpd_evidenceuserinfo",args:params}])[0].done((function(resp){_modal_factory.default.create({title:(0,_str.get_string)("evidenceuserview","local_cpd"),body:resp.options}).done(function(modal){this.modal=modal,modal.show()}.bind(this))})).fail((function(){}))}let viewevidence=e.target.closest(Selectors_actions.viewevidence);if(viewevidence){const ceid=viewevidence.getAttribute("data-id"),evdtype=viewevidence.getAttribute("data-type");var params;(params={}).ceid=ceid,params.evdtype=evdtype,_ajax.default.call([{methodname:"local_cpd_viewevidence",args:params}])[0].done((function(resp){_modal_factory.default.create({title:(0,_str.get_string)("view","local_cpd"),body:resp.options}).done(function(modal){this.modal=modal,modal.show()}.bind(this))})).fail((function(){}))}let deleteevidence=e.target.closest(Selectors_actions.deleteevidence);if(deleteevidence){const evidid=deleteevidence.getAttribute("data-id"),evdtitle=deleteevidence.getAttribute("data-name"),evidtype=deleteevidence.getAttribute("data-type"),totalcount=deleteevidence.getAttribute("data-totalcount");_modal_factory.default.create({title:(0,_str.get_string)("delete","local_cpd"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("deleteconfirm","local_cpd",evdtitle)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("delete_cpd","local_cpd")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={confirm:!0};params.evidid=evidid,params.evidtype=evidtype,_ajax.default.call([{methodname:"local_cpd_deleteevidence",args:params}])[0].done((function(){totalcount>1?window.location.reload(!0):window.location.href=M.cfg.wwwroot+"/local/cpd/index.php"})).fail((function(){}))}.bind(this)),modal.show()}.bind(this))}let addtrainigprogram=e.target.closest(Selectors_actions.edittrainigprogram);if(addtrainigprogram){e.preventDefault();const title=(0,_str.get_string)("addtrainingprograms","local_cpd"),form=new _modalform.default({formClass:"local_cpd\\form\\trainingprogram_form",args:{id:addtrainigprogram.getAttribute("data-id"),cpdid:addtrainigprogram.getAttribute("data-cpdid")},modalConfig:{title:title},returnFocus:addtrainigprogram});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let deletetrainigprogram=e.target.closest(Selectors_actions.deletetrainigprogram);if(deletetrainigprogram){const programid=deletetrainigprogram.getAttribute("data-id"),programname=deletetrainigprogram.getAttribute("data-name");_modal_factory.default.create({title:(0,_str.get_string)("delete","local_cpd"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("deleteconfirm","local_cpd",programname)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("delete_cpd","local_cpd")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={confirm:!0};params.programid=programid,_ajax.default.call([{methodname:"local_cpd_delete_training_program",args:params}])[0].done((function(){window.location.reload(!0)})).fail((function(){}))}.bind(this)),modal.show()}.bind(this))}}))}}));

//# sourceMappingURL=cpdform.min.js.map