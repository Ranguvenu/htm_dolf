define("local_sector/jobrole_level",["exports","local_trainingprogram/dynamicform","core_form/modalform","core/modal_factory","core/modal_events","core/templates","core/ajax","core/str","jquery","theme_academy/homepage"],(function(_exports,_dynamicform,_modalform,_modal_factory,_modal_events,_templates,_ajax,_str,_jquery,_homepage){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_dynamicform=_interopRequireDefault(_dynamicform),_modalform=_interopRequireDefault(_modalform),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_templates=_interopRequireDefault(_templates),_ajax=_interopRequireDefault(_ajax),_jquery=_interopRequireDefault(_jquery),_homepage=_interopRequireDefault(_homepage);const Selectors_actions={createJobrole:'[data-action="createjobrole_level"]',deletejobrole_level:'[data-action="deletejobrole_level"]',responsibilityview:'[data-action="responsibilityview"]',createJobrole_resp:'[data-action="createjobrole_resp"]',deleteresponsibility:'[data-action="deleteresponsibility"]'};let HomePage=new _homepage.default;_exports.init=()=>{document.addEventListener("click",(function(e){let element=e.target.closest(Selectors_actions.createJobrole);if(e.stopImmediatePropagation(),element){e.preventDefault();const title=element.getAttribute("data-id")?(0,_str.get_string)("editlevel","local_sector",element.getAttribute("data-name")):(0,_str.get_string)("addlevel","local_sector"),form=new _modalform.default({formClass:"local_sector\\form\\jobrole_level",args:{id:element.getAttribute("data-id"),jobfamilyid:element.getAttribute("data-jobfamilyid")},modalConfig:{title:title},returnFocus:element});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let deletejobrole_level=e.target.closest(Selectors_actions.deletejobrole_level);if(deletejobrole_level){e.preventDefault();const roleid=deletejobrole_level.getAttribute("data-id"),rolename=deletejobrole_level.getAttribute("data-name");_modal_factory.default.create({title:(0,_str.get_string)("deletelevelconfirm","local_sector"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("leveldeleteconfirm","local_sector",rolename)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("deletetext","local_sector")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.elementid=roleid,params.elementtype="jobrole",_ajax.default.call([{methodname:"local_sector_candeleteelement",args:params}])[0].done((function(resp){if(1==resp.candelete)modal.hide(),HomePage.confirmbox((0,_str.get_string)("remove_dependency","local_sector"));else{var params={};params.roleid=roleid,_ajax.default.call([{methodname:"local_sector_deletejobrole_level",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}let responsibilityview=e.target.closest(Selectors_actions.responsibilityview);if(responsibilityview){e.stopImmediatePropagation();const roleid=responsibilityview.getAttribute("data-roleid"),jobfamilyid=responsibilityview.getAttribute("data-jobfamilyid");var options={};options.roleid=roleid,options.jobfamilyid=jobfamilyid;var trigger=(0,_jquery.default)(Selectors_actions.responsibilityview);_modal_factory.default.create({title:(0,_str.get_string)("responsibilityview","local_sector"),body:_templates.default.render("local_sector/responsibilityview_display",options)},trigger).done((function(modal){this.modal=modal,this.modal.setLarge(),modal.show(),modal.getRoot().on(_modal_events.default.hidden,function(){modal.destroy()}.bind(this))}))}if(createJobrole_resp=e.target.closest(Selectors_actions.createJobrole_resp),createJobrole_resp){e.preventDefault();const title=createJobrole_resp.getAttribute("data-id")?(0,_str.get_string)("editsector","local_sector",createJobrole_resp.getAttribute("data-name")):(0,_str.get_string)("addresp","local_sector"),form=new _modalform.default({formClass:"local_sector\\form\\jobrole_resp",args:{id:createJobrole_resp.getAttribute("data-id"),jobfamilyid:createJobrole_resp.getAttribute("data-jobfamilyid"),roleid:createJobrole_resp.getAttribute("data-roleid")},modalConfig:{title:title},returnFocus:createJobrole_resp});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}let deleteresponsibility=e.target.closest(Selectors_actions.deleteresponsibility);if(deleteresponsibility){e.preventDefault();const responsibilityid=deleteresponsibility.getAttribute("data-id");_modal_factory.default.create({title:(0,_str.get_string)("deletelevelconfirm","local_sector"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("rsponsedeleteconfirm","local_sector")}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("deletetext","local_sector")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var params={};params.responseid=responsibilityid,_ajax.default.call([{methodname:"local_sector_deleteresponsibility",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}}))}}));

//# sourceMappingURL=jobrole_level.min.js.map