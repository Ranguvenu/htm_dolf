{"version":3,"file":"ajaxforms.min.js","sources":["../src/ajaxforms.js"],"sourcesContent":["/**\r\n * Add a create new group modal to the page.\r\n *\r\n * @module     block_learnerscript/ajaxforms\r\n * @class      AjaxForms\r\n * @package    block_learnerscript\r\n * @copyright  2017 Mukka Arun Kumar <arun@eabyas.in>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\ndefine(['jquery',\r\n        'core/str',\r\n        'core/modal_factory',\r\n        'core/modal_events',\r\n        'core/fragment',\r\n        'block_learnerscript/ajax',\r\n        'block_learnerscript/schedule',\r\n        'block_learnerscript/select2',\r\n        'core/yui',\r\n        'core/templates',\r\n        'core/modal',\r\n        'block_learnerscript/helper',\r\n        'jqueryui'\r\n        ],\r\n    function($, Str, ModalFactory, ModalEvents, Fragment, Ajax, schedule,select2, Y, Templates, Modal, helper) {\r\n\r\n        /**\r\n         * Constructor\r\n         *\r\n         * @param {Object} args Contains list of parameters.\r\n         * @param {string} url Ajax request URL.\r\n         *\r\n         * Each call to init gets it's own instance of this class.\r\n         */\r\n        var AjaxForms = function(args, url) {\r\n            this.args = args;\r\n            this.contextid = 1;\r\n            this.url = url;\r\n            this.nodeContent = args.nodeContent || 'ajaxForm';\r\n            this.init(this.args);\r\n        };\r\n\r\n        /**\r\n         * @var {Modal} modal\r\n         * @private\r\n         */\r\n        AjaxForms.prototype.modal = null;\r\n\r\n        /**\r\n         * @var {int} contextid\r\n         * @private\r\n         */\r\n        AjaxForms.prototype.contextid = -1;\r\n\r\n        /**\r\n         * Initialise the class.\r\n         *\r\n         * @param {String} selector used to find triggers for the new group modal.\r\n         * @private\r\n         * @return {Promise}\r\n         */\r\n        AjaxForms.prototype.init = function(args) {\r\n            var resp = this.getBody();\r\n            var self = this;\r\n            var dialogueclass = \"\";\r\n            resp.done(function(data) {\r\n                $('body').append(\"<div class='\" + self.nodeContent + \"'></div>\");\r\n                Templates.replaceNodeContents('.' + self.nodeContent, data.html, '');\r\n                var title_img = '';\r\n                var position = '#viewreport' + args.reportid;\r\n                var width = '80%';\r\n                var my = \"center top\";\r\n                var at =  \"center top\";\r\n                if (args.action == 'schreportform') {\r\n                    dialogueclass = 'schreportform';\r\n                    title_img = \"<img class='dialog_title_icon' alt='Schedule' src='\" +\r\n                        M.util.image_url(\"schreportform\", \"block_learnerscript\") + \"' />\";\r\n                    position = \"#inst\" + args.instanceid;\r\n                    width = '60%';\r\n                    my = \"center\";\r\n                    at =  \"center\";\r\n                } else if (args.action == 'advancedcolumns') {\r\n                    dialogueclass = 'advancedcolumns';\r\n                    position = \".ls_components\";                   \r\n                    width = '60%';\r\n                    my = \"center top\";\r\n                    at =  \"center top\";\r\n                } else if (args.action == 'sendreportemail') {\r\n                    dialogueclass = 'sendreportemail';\r\n                    title_img = \"<img class='dialog_title_icon' alt='Email' src='\" + M.util.image_url(\"email_icon\", \"block_learnerscript\") + \"'/>\";\r\n                    position = \"#inst\" + args.instanceid;\r\n                    width = '60%';\r\n                    my = \"center\";\r\n                    at =  \"center\";\r\n                } else if (args.action == 'advancedfilters') {\r\n                    dialogueclass = 'advancedfilters';\r\n                    position = \".ls_components\";                   \r\n                    width = '60%';\r\n                    my = \"center top\";\r\n                    at =  \"center top\";\r\n                }\r\n\r\n                $('head').append(data.javascript);\r\n\r\n                var dlg = $(\".\" + self.nodeContent).dialog({\r\n                    resizable: true,\r\n                    autoOpen: false,\r\n                    width: width,\r\n                    dialogClass: dialogueclass,\r\n                    // dialogClass: 'schedule-popup',\r\n                    title: self.args.title,\r\n                    modal: true,\r\n                    appendTo: position,\r\n                    position: {\r\n                        my: my,\r\n                        at: at,\r\n                        of: position,\r\n                        within: position\r\n                    },\r\n                    close: function(event, ui) {\r\n                        $(this).dialog('destroy').remove();\r\n                    },\r\n                    open: function() {\r\n                         $(this).closest(\".ui-dialog\")\r\n                                .find(\".ui-dialog-titlebar-close\")\r\n                                .removeClass(\"ui-dialog-titlebar-close\")\r\n                                .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\r\n                            var Closebutton = $('.ui-icon-closethick').parent();\r\n                            $(Closebutton).attr({\r\n                                \"title\" : \"Close\"\r\n                            });\r\n                        $(this).closest(\".ui-dialog\")\r\n                               .find('.ui-dialog-title').html(title_img + self.args.title);\r\n                    }\r\n                });\r\n                if (args.action == 'schreportform') {\r\n                    $(\".\" + self.nodeContent + \" select[data-select2='1']\").select2();\r\n                    schedule.SelectRoleUsers();\r\n                } else if (args.action == 'sendreportemail') {\r\n                    helper = require('block_learnerscript/helper');\r\n                    helper.Select2Ajax({\r\n                        'action': 'userlist',\r\n                        'reportid': args.reportid,\r\n                        'maximumSelectionLength': 0\r\n                    });\r\n                }\r\n                $('.' + self.nodeContent + ' .mform').bind('submit', function(e) {\r\n                    e.preventDefault();\r\n                    return self.submitFormAjax(this);\r\n                });\r\n\r\n                if (args.action == 'plotforms' && (args.pname == 'bar' || args.pname == 'column' || args.pname == 'line' || args.pname == 'combination')) {\r\n                    \r\n                    $(\".\" + self.nodeContent + \" select[data-select2='1']\").select2({\r\n                        theme: \"classic\"\r\n                    });\r\n                    $(document).on('click','.fa-eye', function(e){\r\n                        e.stopImmediatePropagation();\r\n                        $(e.target).parents('.form-group').find('*').attr('disabled', true);\r\n                        $(e.target).switchClass(\"fa-eye\", \"fa-eye-slash\");\r\n                        $(e.target).attr('title', 'Enable');\r\n                    });\r\n                    $(document).on('click','.fa-eye-slash', function(e){\r\n                        e.stopImmediatePropagation();\r\n                        $(e.target).parents('.form-group').find('*').removeAttr('disabled');\r\n                        $(e.target).switchClass( \"fa-eye-slash\", \"fa-eye\");\r\n                        $(e.target).attr('title', 'Disable');\r\n                    });\r\n                    $(document).on('change', '#id_calcs', function() {\r\n                        var calcval = $(this).val();\r\n                        if (calcval) {\r\n                            $('#id_columnsort').prop(\"disabled\", true);\r\n                            $('#id_sorting').prop(\"disabled\", true);\r\n                            $('#id_limit').prop(\"disabled\", true);\r\n                        } else {\r\n                            $('#id_columnsort').prop(\"disabled\", false);\r\n                            $('#id_sorting').prop(\"disabled\", false);\r\n                            $('#id_limit').prop(\"disabled\", false);\r\n                        }\r\n                    });\r\n                }\r\n\r\n                dlg.dialog(\"open\");\r\n            }).fail(function(ex) {\r\n\r\n            });\r\n\r\n        };\r\n\r\n        /**\r\n         * @method getBody\r\n         * @private\r\n         * @return {Promise}\r\n         */\r\n        AjaxForms.prototype.getBody = function(formdata) {\r\n            if (typeof formdata === \"undefined\") {\r\n                formdata = null;\r\n            } else {\r\n                // Get the content of the modal.\r\n                this.args.jsonformdata = JSON.stringify(formdata);\r\n            }\r\n\r\n            var promise = Ajax.call({\r\n                args: this.args,\r\n                url: this.url\r\n            }, false);\r\n\r\n            return promise;\r\n        };\r\n\r\n        /**\r\n         * @method handleFormSubmissionResponse\r\n         * @private\r\n         * @return {Promise}\r\n         */\r\n        AjaxForms.prototype.handleFormSubmissionResponse = function(data) {\r\n            var helper = require('block_learnerscript/helper');\r\n            if (data.formerror) {\r\n                Templates.replaceNodeContents('.' + this.nodeContent, data.html, '');\r\n                $('head').append(data.javascript);\r\n\r\n                var self = this;\r\n                $('.' + this.nodeContent + ' .mform').bind('submit', function(e) {\r\n                    e.preventDefault();\r\n                    self.submitFormAjax(this);\r\n                });\r\n                if (this.args.action == 'schreportform') {\r\n                    $(\".\" + self.nodeContent+\" select[data-select2='1']\").select2();\r\n                    schedule.SelectRoleUsers();\r\n                } else if (this.args.action == 'sendreportemail') {\r\n                    helper = require('block_learnerscript/helper');\r\n                    helper.Select2Ajax({\r\n                        'action': 'userlist',\r\n                        'reportid': this.args.reportid,\r\n                        'maximumSelectionLength': 0\r\n                    });\r\n                }else{\r\n                    $(\".\" + self.nodeContent + \" select[data-select2='1']\").select2({\r\n                        theme: \"classic\"\r\n                    });\r\n                }\r\n            } else {\r\n                if (this.args.component == 'columns') {\r\n                    var app = angular.element(\".simpleDemo\").scope();\r\n                    var pluginname = this.args.advancedcolumn;\r\n                    app.$apply(function() {\r\n                        var plugindata = {};\r\n                        plugindata.id = data.data.id;\r\n                        delete data.data.id;\r\n                        plugindata.pluginname = pluginname;\r\n                        plugindata.pluginfullname = pluginname;\r\n                        plugindata.summary = '';\r\n                        plugindata.type = 'selectedcolumns';\r\n                        plugindata.formdata = data.data;\r\n                        app.lists.columns.elements.push(plugindata);\r\n                    });\r\n\r\n                    $(\".\" + this.nodeContent).dialog('destroy').remove();\r\n                } else if (this.args.component == 'filters') {\r\n                    var app = angular.element(\".simpleDemo\").scope();\r\n                    var pluginname = this.args.advancedfilter;\r\n                    app.$apply(function() {\r\n                        var plugindata = {};\r\n                        plugindata.id = data.data.id;\r\n                        delete data.data.id;\r\n                        plugindata.pluginname = data.data.column;\r\n                        plugindata.pluginfullname = data.data.column;\r\n                        plugindata.summary = '';\r\n                        plugindata.type = 'selectedfilters';\r\n                        plugindata.formdata = data.data;\r\n                        plugindata.formdata.name = data.data.column;\r\n                        plugindata.formdata.type = 'filters';\r\n                        plugindata.advfiltertype = '';\r\n                        delete data.data.column;\r\n                        app.lists.filters.elements.push(plugindata);\r\n                    });\r\n                    $(\".\" + this.nodeContent).dialog('destroy').remove();\r\n                }else {\r\n                    if (this.args.action == 'schreportform') {\r\n                        $(\".\" + this.nodeContent).dialog('close');\r\n                        Str.get_string('reportschedule', 'block_learnerscript').then(function(s) {\r\n                            helper.notifications(s);\r\n                        });\r\n                    } else if (this.args.action == 'plotforms') {\r\n                        var self = this;\r\n                        $(\".\" + this.nodeContent).dialog('close');\r\n                        Str.get_strings([{\r\n                            key: 'graphcreated',\r\n                            component: 'block_learnerscript'\r\n                        }, {\r\n                            key: 'graphupdated',\r\n                            component: 'block_learnerscript'\r\n                        }]).then(function(s) {\r\n                            var message;\r\n                            var cid;\r\n                            var templatename;\r\n                            var tabdata;\r\n                            if (self.args.type == 'add') {\r\n                                helper.notifications(s[0]);\r\n                                // $(\"#report_plottabs\").removeClass(\"ui-tabs-vertical ui-helper-clearfix\");\r\n                                // $(\"#report_plottabs li\").removeClass(\"ui-corner-left\");\r\n                                // var num_tabs = $(\"div#report_plottabs ul li\").length + 1;\r\n                                var reportid = self.args.reportid;\r\n                                cid = data.data.id;\r\n                                var CreateDashboardwidget = {};\r\n                                CreateDashboardwidget.reportid = reportid;\r\n                                CreateDashboardwidget.chartid = data.data.id;\r\n                                CreateDashboardwidget.reporttype = data.data.id;\r\n                                CreateDashboardwidget.pluginname = self.args.pname;\r\n                                CreateDashboardwidget.chartname = data.data.chartname;\r\n                                CreateDashboardwidget.issiteadmin = true;\r\n                                CreateDashboardwidget.editicon = M.util.image_url(\"t/edit\");\r\n                                Str.get_string(self.args.pname , 'block_learnerscript').then(function(s){\r\n                                    CreateDashboardwidget.title = s ;\r\n                                });\r\n                                CreateDashboardwidget.cid = data.data.id;\r\n                                CreateDashboardwidget.pname = self.args.pname;\r\n                                CreateDashboardwidget.type = 'edit';\r\n                                CreateDashboardwidget.deleteicon = M.util.image_url(\"t/delete\") ;\r\n                                CreateDashboardwidget.pname = self.args.pname;\r\n                                CreateDashboardwidget.type = 'edit';\r\n                                if ($('#report_plottabs').length > 0) {\r\n                                    templatename = 'block_learnerscript/tabs';\r\n                                    tabdata = CreateDashboardwidget;\r\n                                } else {\r\n                                    templatename = 'block_learnerscript/plottabs';\r\n                                    var CreateDashboardwidgetargs = {};\r\n                                    CreateDashboardwidgetargs.reportid = reportid;\r\n                                    CreateDashboardwidgetargs.multiplot = true;\r\n                                    CreateDashboardwidgetargs.enableplots = false;\r\n                                    CreateDashboardwidgetargs.plottabs = CreateDashboardwidget;\r\n                                    tabdata = CreateDashboardwidgetargs;\r\n                                }\r\n\r\n                                Templates.render(templatename, tabdata).done(function(tab) {\r\n                                    // $( \"#report_plottabs\" ).tabs( \"destroy\" );\r\n                                    if ($('#report_plottabs').length > 0) {\r\n                                        $(\"span#report_plottabs ul\").append(tab);\r\n                                    } else {\r\n                                        $(\"span.filter_buttons\").prepend(tab);\r\n                                    }\r\n\r\n                                    $('.plotgraphcontainer').removeClass('show').addClass('hide');\r\n                                    $('#plotreportcontainer' + reportid).html('');\r\n\r\n                                    // $('#report_plottabs').tabs().addClass(\"ui-tabs-vertical ui-helper-clearfix\");\r\n                                    // $(\"#report_plottabs li\").removeClass(\"ui-corner-top\");\r\n                                    // $(\"#report_plottabs li\").addClass(\"ui-corner-left\");\r\n                                    // $('#report_plottabs').tabs(\"refresh\");\r\n                                    // $('#' + data.data.id).trigger('click');\r\n                                });\r\n                            } else if (self.args.type == 'edit') {\r\n                                helper.notifications(s[1]);\r\n                                cid = self.args.cid;\r\n                                $('#lschartname' + cid).text(data.data.chartname);\r\n                                $('#' + cid).trigger('click');\r\n                            }\r\n                        });\r\n                    }  else if (this.args.action == 'sendreportemail') {\r\n                        $(\".\" + this.nodeContent).dialog('close');\r\n                        Str.get_string('mailscheduled', 'block_learnerscript').then(function(s) {\r\n                            helper.notifications(s);\r\n                        });\r\n                    } else {\r\n                        window.location.reload();\r\n                    }\r\n                }\r\n            }\r\n\r\n        };\r\n\r\n        /**\r\n         * @method handleFormSubmissionFailure\r\n         * @private\r\n         * @return {Promise}\r\n         */\r\n        AjaxForms.prototype.handleFormSubmissionFailure = function(data) {\r\n\r\n        };\r\n\r\n        /**\r\n         * Private method\r\n         *\r\n         * @method submitFormAjax\r\n         * @private\r\n         * @param {Event} e Form submission event.\r\n         */\r\n        AjaxForms.prototype.submitFormAjax = function(form) {\r\n            // if (skipClientValidation) {\r\n            //     $('.' + this.nodeContent).dialog('destroy').remove();\r\n            //     return true;\r\n            // }\r\n            // We don't want to do a real form submission.\r\n            // Convert all the form elements values to a serialised string.\r\n            this.args.jsonformdata = $(form).serialize();\r\n            var self = this;\r\n            var promise = Ajax.call({\r\n                args: this.args,\r\n                url: this.url\r\n            });\r\n            promise.done(function(response) {\r\n                return self.handleFormSubmissionResponse(response);\r\n            }).fail(function(ex) {\r\n                console.log(ex);\r\n            });\r\n        };\r\n\r\n        /**\r\n         * This triggers a form submission, so that any mform elements can do final tricks before the form submission is processed.\r\n         *\r\n         * @method submitForm\r\n         * @param {Event} e Form submission event.\r\n         * @private\r\n         */\r\n        AjaxForms.prototype.submitForm = function(e) {\r\n            e.preventDefault();\r\n            this.modal.getRoot().find('form').submit();\r\n        };\r\n\r\n        return /** @alias module:core_group/AjaxForms */ {\r\n            // Public variables and functions.\r\n            /**\r\n             * Attach event listeners to initialise this module.\r\n             *\r\n             * @method init\r\n             * @param {object} args The CSS selector used to find nodes that will trigger this module.\r\n             * @param {string} url Ajax request URL.\r\n             * @return {Promise}\r\n             */\r\n            init: function(args, url) {\r\n                return new AjaxForms(args, url);\r\n            }\r\n        };\r\n    });\r\n"],"names":["define","$","Str","ModalFactory","ModalEvents","Fragment","Ajax","schedule","select2","Y","Templates","Modal","helper","AjaxForms","args","url","contextid","nodeContent","init","this","prototype","modal","resp","getBody","self","dialogueclass","done","data","append","replaceNodeContents","html","title_img","position","reportid","width","my","at","action","M","util","image_url","instanceid","javascript","dlg","dialog","resizable","autoOpen","dialogClass","title","appendTo","of","within","close","event","ui","remove","open","closest","find","removeClass","Closebutton","parent","attr","SelectRoleUsers","require","Select2Ajax","bind","e","preventDefault","submitFormAjax","pname","theme","document","on","stopImmediatePropagation","target","parents","switchClass","removeAttr","val","prop","fail","ex","formdata","jsonformdata","JSON","stringify","call","handleFormSubmissionResponse","formerror","component","app","angular","element","scope","pluginname","advancedcolumn","$apply","plugindata","id","pluginfullname","summary","type","lists","columns","elements","push","advancedfilter","column","name","advfiltertype","filters","get_string","then","s","notifications","get_strings","key","cid","templatename","tabdata","CreateDashboardwidget","chartid","reporttype","chartname","issiteadmin","editicon","deleteicon","length","CreateDashboardwidgetargs","multiplot","enableplots","plottabs","render","tab","prepend","addClass","text","trigger","window","location","reload","handleFormSubmissionFailure","form","serialize","response","console","log","submitForm","getRoot","submit"],"mappings":";;;;;;;;;AASAA,uCAAO,CAAC,SACA,WACA,qBACA,oBACA,gBACA,2BACA,+BACA,8BACA,WACA,iBACA,aACA,6BACA,aAEJ,SAASC,EAAGC,IAAKC,aAAcC,YAAaC,SAAUC,KAAMC,SAASC,QAASC,EAAGC,UAAWC,MAAOC,YAU3FC,UAAY,SAASC,KAAMC,UACtBD,KAAOA,UACPE,UAAY,OACZD,IAAMA,SACNE,YAAcH,KAAKG,aAAe,gBAClCC,KAAKC,KAAKL,cAOnBD,UAAUO,UAAUC,MAAQ,KAM5BR,UAAUO,UAAUJ,WAAa,EASjCH,UAAUO,UAAUF,KAAO,SAASJ,UAC5BQ,KAAOH,KAAKI,UACZC,KAAOL,KACPM,cAAgB,GACpBH,KAAKI,MAAK,SAASC,MACf1B,EAAE,QAAQ2B,OAAO,eAAiBJ,KAAKP,YAAc,YACrDP,UAAUmB,oBAAoB,IAAML,KAAKP,YAAaU,KAAKG,KAAM,QAC7DC,UAAY,GACZC,SAAW,cAAgBlB,KAAKmB,SAChCC,MAAQ,MACRC,GAAK,aACLC,GAAM,aACS,iBAAftB,KAAKuB,QACLZ,cAAgB,gBAChBM,UAAY,sDACRO,EAAEC,KAAKC,UAAU,gBAAiB,uBAAyB,OAC/DR,SAAW,QAAUlB,KAAK2B,WAC1BP,MAAQ,MACRC,GAAK,SACLC,GAAM,UACgB,mBAAftB,KAAKuB,QACZZ,cAAgB,kBAChBO,SAAW,iBACXE,MAAQ,MACRC,GAAK,aACLC,GAAM,cACgB,mBAAftB,KAAKuB,QACZZ,cAAgB,kBAChBM,UAAY,mDAAqDO,EAAEC,KAAKC,UAAU,aAAc,uBAAyB,MACzHR,SAAW,QAAUlB,KAAK2B,WAC1BP,MAAQ,MACRC,GAAK,SACLC,GAAM,UACgB,mBAAftB,KAAKuB,SACZZ,cAAgB,kBAChBO,SAAW,iBACXE,MAAQ,MACRC,GAAK,aACLC,GAAM,cAGVnC,EAAE,QAAQ2B,OAAOD,KAAKe,gBAElBC,IAAM1C,EAAE,IAAMuB,KAAKP,aAAa2B,OAAO,CACvCC,WAAW,EACXC,UAAU,EACVZ,MAAOA,MACPa,YAAatB,cAEbuB,MAAOxB,KAAKV,KAAKkC,MACjB3B,OAAO,EACP4B,SAAUjB,SACVA,SAAU,CACNG,GAAIA,GACJC,GAAIA,GACJc,GAAIlB,SACJmB,OAAQnB,UAEZoB,MAAO,SAASC,MAAOC,IACnBrD,EAAEkB,MAAMyB,OAAO,WAAWW,UAE9BC,KAAM,WACDvD,EAAEkB,MAAMsC,QAAQ,cACRC,KAAK,6BACLC,YAAY,4BACZ7B,KAAK,+EACN8B,YAAc3D,EAAE,uBAAuB4D,SAC3C5D,EAAE2D,aAAaE,KAAK,OACN,UAElB7D,EAAEkB,MAAMsC,QAAQ,cACRC,KAAK,oBAAoB5B,KAAKC,UAAYP,KAAKV,KAAKkC,UAGjD,iBAAflC,KAAKuB,QACLpC,EAAE,IAAMuB,KAAKP,YAAc,6BAA6BT,UACxDD,SAASwD,mBACa,mBAAfjD,KAAKuB,QACH2B,QAAQ,8BACVC,YAAY,QACL,oBACEnD,KAAKmB,gCACS,IAGlChC,EAAE,IAAMuB,KAAKP,YAAc,WAAWiD,KAAK,UAAU,SAASC,UAC1DA,EAAEC,iBACK5C,KAAK6C,eAAelD,SAGZ,aAAfL,KAAKuB,QAAwC,OAAdvB,KAAKwD,OAAgC,UAAdxD,KAAKwD,OAAmC,QAAdxD,KAAKwD,OAAiC,eAAdxD,KAAKwD,QAE7GrE,EAAE,IAAMuB,KAAKP,YAAc,6BAA6BT,QAAQ,CAC5D+D,MAAO,YAEXtE,EAAEuE,UAAUC,GAAG,QAAQ,WAAW,SAASN,GACvCA,EAAEO,2BACFzE,EAAEkE,EAAEQ,QAAQC,QAAQ,eAAelB,KAAK,KAAKI,KAAK,YAAY,GAC9D7D,EAAEkE,EAAEQ,QAAQE,YAAY,SAAU,gBAClC5E,EAAEkE,EAAEQ,QAAQb,KAAK,QAAS,aAE9B7D,EAAEuE,UAAUC,GAAG,QAAQ,iBAAiB,SAASN,GAC7CA,EAAEO,2BACFzE,EAAEkE,EAAEQ,QAAQC,QAAQ,eAAelB,KAAK,KAAKoB,WAAW,YACxD7E,EAAEkE,EAAEQ,QAAQE,YAAa,eAAgB,UACzC5E,EAAEkE,EAAEQ,QAAQb,KAAK,QAAS,cAE9B7D,EAAEuE,UAAUC,GAAG,SAAU,aAAa,WACpBxE,EAAEkB,MAAM4D,OAElB9E,EAAE,kBAAkB+E,KAAK,YAAY,GACrC/E,EAAE,eAAe+E,KAAK,YAAY,GAClC/E,EAAE,aAAa+E,KAAK,YAAY,KAEhC/E,EAAE,kBAAkB+E,KAAK,YAAY,GACrC/E,EAAE,eAAe+E,KAAK,YAAY,GAClC/E,EAAE,aAAa+E,KAAK,YAAY,QAK5CrC,IAAIC,OAAO,WACZqC,MAAK,SAASC,SAWrBrE,UAAUO,UAAUG,QAAU,SAAS4D,sBACX,IAAbA,SACPA,SAAW,UAGNrE,KAAKsE,aAAeC,KAAKC,UAAUH,UAG9B7E,KAAKiF,KAAK,CACpBzE,KAAMK,KAAKL,KACXC,IAAKI,KAAKJ,MACX,IAUPF,UAAUO,UAAUoE,6BAA+B,SAAS7D,UACpDf,OAASoD,QAAQ,iCACjBrC,KAAK8D,UAAW,CAChB/E,UAAUmB,oBAAoB,IAAMV,KAAKF,YAAaU,KAAKG,KAAM,IACjE7B,EAAE,QAAQ2B,OAAOD,KAAKe,gBAElBlB,KAAOL,KACXlB,EAAE,IAAMkB,KAAKF,YAAc,WAAWiD,KAAK,UAAU,SAASC,GAC1DA,EAAEC,iBACF5C,KAAK6C,eAAelD,SAEA,iBAApBA,KAAKL,KAAKuB,QACVpC,EAAE,IAAMuB,KAAKP,YAAY,6BAA6BT,UACtDD,SAASwD,mBACkB,mBAApB5C,KAAKL,KAAKuB,QACjBzB,OAASoD,QAAQ,+BACVC,YAAY,QACL,oBACE9C,KAAKL,KAAKmB,gCACI,IAG9BhC,EAAE,IAAMuB,KAAKP,YAAc,6BAA6BT,QAAQ,CAC5D+D,MAAO,oBAIY,WAAvBpD,KAAKL,KAAK4E,UAAwB,KAC9BC,IAAMC,QAAQC,QAAQ,eAAeC,QACrCC,WAAa5E,KAAKL,KAAKkF,eAC3BL,IAAIM,QAAO,eACHC,WAAa,GACjBA,WAAWC,GAAKxE,KAAKA,KAAKwE,UACnBxE,KAAKA,KAAKwE,GACjBD,WAAWH,WAAaA,WACxBG,WAAWE,eAAiBL,WAC5BG,WAAWG,QAAU,GACrBH,WAAWI,KAAO,kBAClBJ,WAAWf,SAAWxD,KAAKA,KAC3BgE,IAAIY,MAAMC,QAAQC,SAASC,KAAKR,eAGpCjG,EAAE,IAAMkB,KAAKF,aAAa2B,OAAO,WAAWW,cACzC,GAA2B,WAAvBpC,KAAKL,KAAK4E,UAAwB,CACrCC,IAAMC,QAAQC,QAAQ,eAAeC,QACrCC,WAAa5E,KAAKL,KAAK6F,eAC3BhB,IAAIM,QAAO,eACHC,WAAa,GACjBA,WAAWC,GAAKxE,KAAKA,KAAKwE,UACnBxE,KAAKA,KAAKwE,GACjBD,WAAWH,WAAapE,KAAKA,KAAKiF,OAClCV,WAAWE,eAAiBzE,KAAKA,KAAKiF,OACtCV,WAAWG,QAAU,GACrBH,WAAWI,KAAO,kBAClBJ,WAAWf,SAAWxD,KAAKA,KAC3BuE,WAAWf,SAAS0B,KAAOlF,KAAKA,KAAKiF,OACrCV,WAAWf,SAASmB,KAAO,UAC3BJ,WAAWY,cAAgB,UACpBnF,KAAKA,KAAKiF,OACjBjB,IAAIY,MAAMQ,QAAQN,SAASC,KAAKR,eAEpCjG,EAAE,IAAMkB,KAAKF,aAAa2B,OAAO,WAAWW,iBAEpB,iBAApBpC,KAAKL,KAAKuB,OACVpC,EAAE,IAAMkB,KAAKF,aAAa2B,OAAO,SACjC1C,IAAI8G,WAAW,iBAAkB,uBAAuBC,MAAK,SAASC,GAClEtG,OAAOuG,cAAcD,WAEtB,GAAwB,aAApB/F,KAAKL,KAAKuB,OAAuB,CACpCb,KAAOL,KACXlB,EAAE,IAAMkB,KAAKF,aAAa2B,OAAO,SACjC1C,IAAIkH,YAAY,CAAC,CACbC,IAAK,eACL3B,UAAW,uBACZ,CACC2B,IAAK,eACL3B,UAAW,yBACXuB,MAAK,SAASC,OAEVI,IACAC,aACAC,WACkB,OAAlBhG,KAAKV,KAAKwF,KAAe,CACzB1F,OAAOuG,cAAcD,EAAE,QAInBjF,SAAWT,KAAKV,KAAKmB,SACzBqF,IAAM3F,KAAKA,KAAKwE,OACZsB,sBAAwB,MAC5BA,sBAAsBxF,SAAWA,SACjCwF,sBAAsBC,QAAU/F,KAAKA,KAAKwE,GAC1CsB,sBAAsBE,WAAahG,KAAKA,KAAKwE,GAC7CsB,sBAAsB1B,WAAavE,KAAKV,KAAKwD,MAC7CmD,sBAAsBG,UAAYjG,KAAKA,KAAKiG,UAC5CH,sBAAsBI,aAAc,EACpCJ,sBAAsBK,SAAWxF,EAAEC,KAAKC,UAAU,UAClDtC,IAAI8G,WAAWxF,KAAKV,KAAKwD,MAAQ,uBAAuB2C,MAAK,SAASC,GAClEO,sBAAsBzE,MAAQkE,KAElCO,sBAAsBH,IAAM3F,KAAKA,KAAKwE,GACtCsB,sBAAsBnD,MAAQ9C,KAAKV,KAAKwD,MACxCmD,sBAAsBnB,KAAO,OAC7BmB,sBAAsBM,WAAazF,EAAEC,KAAKC,UAAU,YACpDiF,sBAAsBnD,MAAQ9C,KAAKV,KAAKwD,MACxCmD,sBAAsBnB,KAAO,OACzBrG,EAAE,oBAAoB+H,OAAS,EAC/BT,aAAe,2BACfC,QAAUC,0BACP,CACHF,aAAe,mCACXU,0BAA4B,GAChCA,0BAA0BhG,SAAWA,SACrCgG,0BAA0BC,WAAY,EACtCD,0BAA0BE,aAAc,EACxCF,0BAA0BG,SAAWX,sBACrCD,QAAUS,0BAGdvH,UAAU2H,OAAOd,aAAcC,SAAS9F,MAAK,SAAS4G,KAE9CrI,EAAE,oBAAoB+H,OAAS,EAC/B/H,EAAE,2BAA2B2B,OAAO0G,KAEpCrI,EAAE,uBAAuBsI,QAAQD,KAGrCrI,EAAE,uBAAuB0D,YAAY,QAAQ6E,SAAS,QACtDvI,EAAE,uBAAyBgC,UAAUH,KAAK,WAQrB,QAAlBN,KAAKV,KAAKwF,OACjB1F,OAAOuG,cAAcD,EAAE,IACvBI,IAAM9F,KAAKV,KAAKwG,IAChBrH,EAAE,eAAiBqH,KAAKmB,KAAK9G,KAAKA,KAAKiG,WACvC3H,EAAE,IAAMqH,KAAKoB,QAAQ,iBAGD,mBAApBvH,KAAKL,KAAKuB,QAClBpC,EAAE,IAAMkB,KAAKF,aAAa2B,OAAO,SACjC1C,IAAI8G,WAAW,gBAAiB,uBAAuBC,MAAK,SAASC,GACjEtG,OAAOuG,cAAcD,OAGzByB,OAAOC,SAASC,UAYhChI,UAAUO,UAAU0H,4BAA8B,SAASnH,QAW3Dd,UAAUO,UAAUiD,eAAiB,SAAS0E,WAOrCjI,KAAKsE,aAAenF,EAAE8I,MAAMC,gBAC7BxH,KAAOL,KACGb,KAAKiF,KAAK,CACpBzE,KAAMK,KAAKL,KACXC,IAAKI,KAAKJ,MAENW,MAAK,SAASuH,iBACXzH,KAAKgE,6BAA6ByD,aAC1ChE,MAAK,SAASC,IACbgE,QAAQC,IAAIjE,QAWpBrE,UAAUO,UAAUgI,WAAa,SAASjF,GACtCA,EAAEC,sBACG/C,MAAMgI,UAAU3F,KAAK,QAAQ4F,UAGW,CAU7CpI,KAAM,SAASJ,KAAMC,YACV,IAAIF,UAAUC,KAAMC"}