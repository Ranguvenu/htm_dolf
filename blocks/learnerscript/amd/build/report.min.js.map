{"version":3,"file":"report.min.js","sources":["../src/report.js"],"sourcesContent":["/**\r\n * Standard Report wrapper for Moodle. It calls the central JS file for Report plugin,\r\n * Also it includes JS libraries like Select2,Datatables and Highcharts\r\n * @module     block_learnerscript/report\r\n * @class      report\r\n * @package    block_learnerscript\r\n * @copyright  2017 Naveen kumar <naveen@eabyas.in>\r\n * @since      3.3\r\n */\r\ndefine(['core/str',\r\n    'block_learnerscript/select2',\r\n    'block_learnerscript/responsive.bootstrap',\r\n    'block_learnerscript/reportwidget',\r\n    'block_learnerscript/chart',\r\n    'block_learnerscript/smartfilter',\r\n    'block_learnerscript/helper',\r\n    'block_learnerscript/ajaxforms',\r\n    'block_learnerscript/ajax',\r\n    'jquery',\r\n    'block_learnerscript/radioslider',\r\n    'block_learnerscript/flatpickr',\r\n    'core/templates',\r\n    'jqueryui'\r\n], function(Str, select2, DataTable, reportwidget, chart, smartfilter, helper, AjaxForms, ajax,\r\n    $, RadiosToSlider, flatpickr, templates) {\r\n    var report;\r\n    var BasicparamCourse = $('.basicparamsform #id_filter_courses');\r\n    var BasicparamUser = $('.basicparamsform #id_filter_users');\r\n    var BasicparamActivity = $('.basicparamsform #id_filter_activities');\r\n    var BasicparamTrainer = $('.basicparamsform #id_filter_trainer');\r\n\r\n    var FilterCourse = $('.filterform #id_filter_courses');\r\n    var FilterUser = $('.filterform #id_filter_users');\r\n    var FilterActivity = $('.filterform #id_filter_activities');\r\n    var FilterModule = $('.filterform #id_filter_modules');\r\n    var FilterCohort = $('.filterform #id_filter_cohort');\r\n    var FilterTrainer = $('.filterform #id_filter_trainer');\r\n\r\n    var NumberOfBasicParams = 0;\r\n\r\n    return report = {\r\n        init: function(args) {\r\n            /**\r\n             * Initialization\r\n             */\r\n            $.ui.dialog.prototype._focusTabbable = $.noop;\r\n            $.fn.dataTable.ext.errMode = 'none';\r\n\r\n            $('.plotgraphcontainer').on('click', function() {\r\n                var reportid = $(this).data('reportid');\r\n                // $(this).removeClass('show').addClass('show');\r\n                $('.plotgraphcontainer').removeClass('show').addClass('hide');\r\n                $('#plotreportcontainer' + reportid).html('');\r\n\r\n            })\r\n            /**\r\n             * Select2 initialization\r\n             */\r\n            $(\"select[data-select2='1']\").select2({\r\n                theme: \"classic\"\r\n            }).on(\"select2:selecting\", function(e) {\r\n                if ($(this).val() && $(this).data('maximumSelectionLength') &&\r\n                    $(this).val().length >= $(this).data('maximumSelectionLength')) {\r\n                    e.preventDefault();\r\n                    $(this).select2('close');\r\n                }\r\n            });\r\n\r\n            /*\r\n             * Report search\r\n             */\r\n            $(\"#reportsearch\").val(args.reportid).trigger('change.select2');\r\n            $(\"#reportsearch\").change(function() {\r\n                var reportid = $(this).find(\":selected\").val();\r\n                window.location = M.cfg.wwwroot + '/blocks/learnerscript/viewreport.php?id=' + reportid;\r\n            });\r\n            /**\r\n             * Duration buttons\r\n             */\r\n            RadiosToSlider.init($('#segmented-button'), {\r\n                size: 'medium',\r\n                animation: true,\r\n                reportdashboard: false\r\n            });\r\n            /**\r\n             * Duration Filter\r\n             */\r\n            flatpickr('#customrange', {\r\n                mode: 'range',\r\n                onOpen: function(selectedDates, dateStr,instance){\r\n                    instance.clear();\r\n                },\r\n                onClose: function(selectedDates, dateStr, instance) {\r\n                    if(selectedDates.length !== 0){\r\n                        $('#ls_fstartdate').val(selectedDates[0].getTime() / 1000);\r\n                        $('#ls_fenddate').val((selectedDates[1].getTime() / 1000) + (60 * 60 * 24));\r\n                        require(['block_learnerscript/report'], function(report) {\r\n                            report.CreateReportPage({ reportid: args.reportid, instanceid: args.reportid, reportdashboard: false });\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n            /*\r\n             * Get users for selected course \r\n             */\r\n            $('#id_filter_cohort').change(function() {\r\n                var cohortid = $(this).find(\":selected\").val();\r\n                if (cohortid > 0 && (FilterUser.length > 0 || BasicparamUser.length > 0)) {\r\n                    if(BasicparamUser.length > 0){\r\n                        FirstElementActive = true;\r\n                    }\r\n                    smartfilter.CohortUsers({ cohortid: cohortid, reporttype: args.reporttype, reportid: args.reportid, \r\n                                              firstelementactive: FirstElementActive});\r\n                }\r\n            });\r\n\r\n            /*\r\n             * Get Activities and Enrolled users for selected course\r\n             */\r\n            if (typeof BasicparamCourse != 'undefined' || typeof FilterCourse != 'undefined') {\r\n                $('#id_filter_courses').change(function() {\r\n                    args.courseid = $(this).find(\":selected\").val();\r\n                    smartfilter.CourseData(args);\r\n                    smartfilter.courseEvolutions(args);\r\n                });\r\n            }\r\n\r\n            /*\r\n             * Get Enrolled courses for selected user\r\n             */\r\n            $('#id_filter_users').change(function() {\r\n                var userid = $(this).find(\":selected\").val();\r\n                if (userid > 0 && (FilterCourse.length > 0 || BasicparamCourse.length > 0)) {\r\n                    if(BasicparamCourse.length > 0){\r\n                        FirstElementActive = true;\r\n                    }\r\n                    // smartfilter.UserCourses({ userid: userid, reporttype: args.reporttype, reportid: args.reportid, \r\n                    //                           firstelementactive: FirstElementActive, triggercourseactivities: true });\r\n                }\r\n            });\r\n\r\n            $('#id_filter_coursecategories').change(function() {\r\n                var categoryid = $(this).find(\":selected\").val();\r\n                smartfilter.categoryCourses({ categoryid: categoryid, reporttype: args.reporttype });\r\n            });\r\n            $('#id_filter_trainingprogram').change(function() {\r\n                var programid = $(this).find(\":selected\").val();\r\n                smartfilter.programofferings({ programid: programid, reporttype: args.reporttype });\r\n            });\r\n            $('#id_filter_code').change(function() {\r\n                var offeringid = $(this).find(\":selected\").val();\r\n                smartfilter.offeringmeetings({ offeringid: offeringid, reporttype: args.reporttype });\r\n            });\r\n            $('#id_filter_virtualactivities').change(function() {\r\n                var moduleinstance = $(this).find(\":selected\").val();\r\n                smartfilter.meetingdates({ moduleinstance: moduleinstance, reporttype: args.reporttype });\r\n            });\r\n\r\n            $('#id_filter_trainingprovider').change(function() {\r\n                var trainingproviderid = $(this).find(\":selected\").val();\r\n                smartfilter.trainerslist({ trainingproviderid: trainingproviderid, reporttype: args.reporttype });\r\n            });\r\n            $('#id_filter_type').change(function() {\r\n                var typeid = $(this).find(\":selected\").val();\r\n                smartfilter.orgslist({ typeid: typeid, reporttype: args.reporttype });\r\n            });\r\n\r\n            schedule.SelectRoleUsers();\r\n\r\n            if (args.basicparams != null) {\r\n                if (args.basicparams[0].name == 'courses') {\r\n                    $(\"#id_filter_courses\").trigger('change');\r\n                    NumberOfBasicParams++;\r\n                }\r\n            }\r\n            if (args.basicparams != null) {\r\n                var FirstElementActive = false;\r\n                if (args.basicparams[0].name == 'users') {\r\n                    if (BasicparamCourse.length > 0) {\r\n                        FirstElementActive = true;\r\n                    }\r\n                    var userid = $(\"#id_filter_users\").find(\":selected\").val();\r\n                    if (userid > 0) {\r\n                        //args.courseid = $(this).find(\":selected\").val();\r\n                        args.courseid = $('#id_filter_courses').find(\":selected\").val();\r\n                        smartfilter.CourseData(args);\r\n                        // smartfilter.UserCourses({ userid: userid, reportid: args.reportid, reporttype: args.reporttype,\r\n                        //                           firstelementactive: FirstElementActive, triggercourseactivities: true });\r\n                    }\r\n                }\r\n            }\r\n\r\n            //For forms formatting..can't make unique everywhere, so little trick ;)\r\n            $('.filterform' + args.reportid + ' .fitemtitle').hide();\r\n            $('.filterform' + args.reportid + ' .felement').attr('style', 'margin:0');\r\n\r\n            $('.basicparamsform' + args.reportid + ' .fitemtitle').hide();\r\n            $('.basicparamsform' + args.reportid + ' .felement').attr('style', 'margin:0');\r\n\r\n            /*\r\n             * Filter form submission\r\n             */\r\n            $(\".filterform #id_filter_clear\").click(function(e) {\r\n                var NumberOfBasicParams = 0;\r\n                $(\".filterform\" + args.reportid).trigger(\"reset\");\r\n                var activityelement = $(this).parent().find('#id_filter_activities');\r\n                if (FilterUser.length > 0) {\r\n                    if (FilterCourse.length > 0 || BasicparamCourse.length > 0) {\r\n                        if(BasicparamCourse.length > 0){\r\n                            FirstElementActive = true;\r\n                        }\r\n                        // smartfilter.UserCourses({ userid: 0, reportid: args.reportid, reporttype: args.reporttype, firstelementactive: FirstElementActive });\r\n                    }\r\n                    // $(\"select[data-select2='1']\").select2(\"destroy\").select2({ theme: \"classic\" });\r\n                }\r\n                if (FilterCourse.length > 0) {\r\n                    if (FilterUser.length > 0 || BasicparamUser.length > 0) {\r\n                        // smartfilter.EnrolledUsers({ courseid: 0, reportid: args.reportid, reporttype: args.reporttype, components: args.components });\r\n                    }\r\n\r\n                    if (FilterActivity.length > 0 || BasicparamActivity.length > 0) {\r\n                        smartfilter.CourseActivities({ courseid: 0 });\r\n                    }\r\n                    // $(\"select[data-select2='1']\").select2(\"destroy\").select2({ theme: \"classic\" });\r\n                }\r\n                if (FilterActivity.length > 0 || FilterModule.length > 0) {\r\n                    if ((FilterCourse.length > 0 || BasicparamCourse.length > 0) && BasicparamUser.length == 0) {\r\n                        if(BasicparamCourse.length > 0 && BasicparamUser.length == 0){\r\n                            FirstElementActive = true;\r\n                        }\r\n                        // smartfilter.UserCourses({ userid: 0, reportid: args.reportid, reporttype: args.reporttype, firstelementactive: FirstElementActive });\r\n                    }\r\n                    if (BasicparamCourse.length > 0 && BasicparamUser.length > 0) {\r\n                            $(\".basicparamsform #id_filter_apply\").trigger('click', [true]);\r\n                    }\r\n                    // $(\"select[data-select2='1']\").select2(\"destroy\").select2({ theme: \"classic\" });\r\n                }\r\n                if (FilterCohort.length > 0) {\r\n                    if (FilterUser.length > 0) {\r\n                        smartfilter.CohortUsers({ cohortid: 0});\r\n                    }\r\n                }\r\n\r\n                if ($(\".basicparamsform #id_filter_apply\").length > 0) {\r\n                    $(document).ajaxComplete(function(event, xhr, settings) {\r\n                        // if (settings.url.indexOf(\"blocks/learnerscript/ajax.php\") > 0) {\r\n                        //     if (typeof settings.data != 'undefined') {\r\n                        //         var ajaxaction = $.parseJSON(settings.data);\r\n                        //         if (typeof ajaxaction.basicparam != 'undefined' && ajaxaction.basicparam == true) {\r\n                        //             NumberOfBasicParams++;\r\n                        //         }\r\n                        //     }\r\n                        //     if (args.basicparams.length == NumberOfBasicParams) {\r\n                        //         $(\".basicparamsform #id_filter_apply\").trigger('click', [true]);\r\n                        //     }\r\n                        // }\r\n                    });\r\n                    $(\".basicparamsform #id_filter_apply\").trigger('click', [true]);\r\n                } else {\r\n                    args.reporttype = $('.ls-plotgraphs_listitem.ui-tabs-active').data('cid');\r\n                    report.CreateReportPage({ reportid: args.reportid, reporttype: args.reporttype, instanceid: args.reportid });\r\n                }\r\n                $(\".filterform select[data-select2='1']\").select2(\"destroy\").select2({ theme: \"classic\" });\r\n                $(\".filterform select[data-select2-ajax='1']\").val('0').trigger('change');\r\n                $('.filterform')[0].reset();\r\n                $(\".filterform #id_filter_clear\").attr('disabled', 'disabled');\r\n                $('.plotgraphcontainer').removeClass('show').addClass('hide');\r\n                $('#plotreportcontainer' + args.instanceid).html('');\r\n            });\r\n\r\n            /*\r\n             * Basic parameters form submission\r\n             */\r\n            $(\".basicparamsform #id_filter_apply,.filterform #id_filter_apply\").click(function(e, validate) {\r\n                var getreport = helper.validatebasicform(validate);\r\n                e.preventDefault();\r\n                e.stopImmediatePropagation();\r\n                $(\".filterform\" + args.reportid).show();\r\n                args.instanceid = args.reportid;\r\n                if(e.currentTarget.value != 'Get Report'){\r\n                    $(\".filterform #id_filter_clear\").removeAttr('disabled');\r\n                }\r\n                if ($.inArray(0, getreport) != -1) {\r\n                    $(\"#report_plottabs\").hide();\r\n                    $(\"#reportcontainer\" + args.reportid).html(\"<div class='alert alert-info'>No data available</div>\");\r\n                } else {\r\n                    $(\"#report_plottabs\").show();\r\n                    args.reporttype = $('.ls-plotgraphs_listitem.ui-tabs-active').data('cid');\r\n                    report.CreateReportPage({ reportid: args.reportid, reporttype: args.reporttype, instanceid: args.instanceid, reportdashboard: false });\r\n                }\r\n                $('.plotgraphcontainer').removeClass('show').addClass('hide');\r\n                $('#plotreportcontainer' + args.instanceid).html('');\r\n            });\r\n            /*\r\n             * Generate Plotgraph\r\n             */\r\n            if (args.basicparams == null) {\r\n                report.CreateReportPage({ reportid: args.reportid, reporttype: args.reporttype, instanceid: args.reportid, reportdashboard: false });\r\n            } else {\r\n                if (args.basicparams.length <= 4) {\r\n                    $(\".basicparamsform #id_filter_apply\").trigger('click', [true]);\r\n                } else {\r\n                        $(document).ajaxComplete(function(event, xhr, settings) {\r\n                            if (settings.url.indexOf(\"blocks/learnerscript/ajax.php\") > 0) {\r\n                                if (typeof settings.data != 'undefined') {\r\n                                    var ajaxaction = $.parseJSON(settings.data);\r\n                                    if (typeof ajaxaction.basicparam != 'undefined' && ajaxaction.basicparam == true) {\r\n                                        NumberOfBasicParams++;\r\n                                    }\r\n                                }\r\n                                if (args.basicparams.length == NumberOfBasicParams\r\n                                    && ajaxaction.action != 'plotforms' && ajaxaction.action != 'pluginlicence') {\r\n                                    $(\".basicparamsform #id_filter_apply\").trigger('click', [true]);\r\n                                }\r\n                            }\r\n                        });\r\n                }\r\n            }\r\n\r\n            /*\r\n             * Make sure will have vertical tabs for plotoptions for report\r\n             */\r\n            // $tabs = $('#report_plottabs').tabs().addClass(\"ui-tabs-vertical ui-helper-clearfix\");\r\n            // $(\"#report_plottabs li\").removeClass(\"ui-corner-top\").addClass(\"ui-corner-left\");\r\n\r\n            // helper.tabsdraggable($tabs);\r\n\r\n        },\r\n        CreateReportPage: function(args) {\r\n            var disabletable = 0;\r\n            if (args.reportdashboard == false) {\r\n                var disabletable = $('#disabletable').val();\r\n                if (disabletable) {\r\n                    args.reporttype = $($('.ls-plotgraphs_listitem')[0]).data('cid');\r\n                }\r\n            }\r\n            if (disabletable == 1 && args.reporttype.length > 0) {\r\n                chart.HighchartsAjax({\r\n                    'reportid': args.reportid,\r\n                    'action': 'generate_plotgraph',\r\n                    'cols': args.cols,\r\n                    'reporttype': args.reporttype\r\n                });\r\n            } else if (disabletable == 0) {\r\n                reportwidget.CreateDashboardwidget({\r\n                    reportid: args.reportid,\r\n                    reporttype: 'table',\r\n                    instanceid: args.instanceid,\r\n                    reportdashboard: args.reportdashboard\r\n                });\r\n            } else {\r\n\r\n            }\r\n        },\r\n        /**\r\n         * Generates graph widget with given Highcharts ajax response\r\n         * @param  object response Ajax response\r\n         * @return Creates highchart widget with given response based on type of chart\r\n         */\r\n        generate_plotgraph: function(response) {\r\n            var returned;\r\n            response.containerid = 'plotreportcontainer' + response.reportinstance;\r\n            switch (response.type) {\r\n                case 'pie':\r\n                    chart.piechart(response);\r\n                    break;\r\n                case 'spline':\r\n                case 'bar':\r\n                case 'column':\r\n                    chart.lbchart(response);\r\n                    break;\r\n                case 'solidgauge':\r\n                    chart.solidgauge(response);\r\n                    break;\r\n                case 'combination':\r\n                    chart.combinationchart(response);\r\n                    break;\r\n                case 'map':\r\n                    chart.WorldMap(response);\r\n                    break;\r\n                case 'treemap':\r\n                    chart.TreeMap(response);\r\n                    break;\r\n            }\r\n        },\r\n        /**\r\n         * Datatable serverside for all table type reports\r\n         * @param object args reportid\r\n         * @return Apply serverside datatable to report table\r\n         */\r\n        ReportDatatable: function(args) {\r\n            var self = this;\r\n            var params = {};\r\n            var reportinstance = args.instanceid ? args.instanceid : args.reportid;\r\n            params['filters'] = args.filters;\r\n            params['basicparams'] = args.basicparams || JSON.stringify(smartfilter.BasicparamsData(reportinstance));\r\n            params['reportid'] = args.reportid;\r\n            params['columns'] = args.columns;\r\n            //\r\n            // Pipelining function for DataTables. To be used to the `ajax` option of DataTables\r\n            //\r\n            $.fn.dataTable.pipeline = function(opts) {\r\n                // Configuration options\r\n                var conf = $.extend({\r\n                    url: '', // script url\r\n                    data: null, // function or object with parameters to send to the server\r\n                    method: 'POST' // Ajax HTTP method\r\n                }, opts);\r\n\r\n                return function(request, drawCallback, settings) {\r\n                    var ajax = true;\r\n                    var requestStart = request.start;\r\n                    var drawStart = request.start;\r\n                    var requestLength = request.length;\r\n                    var requestEnd = requestStart + requestLength;\r\n\r\n                    if (typeof args.data != 'undefined' && request.draw == 1) {\r\n                        json = args.data;\r\n                        json.draw = request.draw; // Update the echo for each response\r\n                        json.data.splice(0, requestStart);\r\n                        json.data.splice(requestLength, json.data.length);\r\n                        drawCallback(json);\r\n                    } else if (ajax) {\r\n                        // Need data from the server\r\n                        request.start = requestStart;\r\n                        request.length = requestLength;\r\n                        $.extend(request, conf.data);\r\n\r\n                        settings.jqXHR = $.ajax({\r\n                            \"type\": conf.method,\r\n                            \"url\": conf.url,\r\n                            \"data\": request,\r\n                            \"dataType\": \"json\",\r\n                            \"cache\": false,\r\n                            \"success\": function(json) {\r\n                                drawCallback(json);\r\n                            }\r\n                        });\r\n                    } else {\r\n                        json = $.extend(true, {}, cacheLastJson);\r\n                        json.draw = request.draw; // Update the echo for each response\r\n                        json.data.splice(0, requestStart - cacheLower);\r\n                        json.data.splice(requestLength, json.data.length);\r\n                        drawCallback(json);\r\n                    }\r\n                }\r\n            };\r\n            if (args.reportname == 'Users profile' || args.reportname == 'Course profile') {\r\n                var lengthoptions = [\r\n                    [50, 100, -1],\r\n                    [\"Show 50\", \"Show 100\", \"Show All\"]\r\n                ];\r\n            } else {\r\n                var lengthoptions = [\r\n                    [10, 25, 50, 100, -1],\r\n                    [\"Show 10\", \"Show 25\", \"Show 50\", \"Show 100\", \"Show All\"]\r\n                ];\r\n            }\r\n\r\n                var oTable = $('#reporttable_' + reportinstance).DataTable({\r\n                    'processing': true,\r\n                    'serverSide': true,\r\n                    'destroy': true,\r\n                    'dom': '<\"co_report_header\"Bf <\"report_header_skew\"  <\"report_header_skew_content\" Bl<\"report_header_showhide\" ><\"report_calculation_showhide\" >> > > tr <\"co_report_footer\"ip>',\r\n                    'ajax': $.fn.dataTable.pipeline({\r\n                        \"type\": \"POST\",\r\n                        \"url\": M.cfg.wwwroot + '/blocks/learnerscript/components/datatable/server_processing.php?sesskey=' + M.cfg.sesskey,\r\n                        \"data\": params\r\n                    }),\r\n                    'columnDefs': args.columnDefs,\r\n                    \"fnDrawCallback\": function(oSettings, json) {\r\n                        chart.SparkLineReport();\r\n                        helper.DrilldownReport();\r\n                    },\r\n                    \"oScroll\": {},\r\n                    'responsive': true,\r\n                    \"fnInitComplete\": function() {\r\n                        this.fnAdjustColumnSizing(true);\r\n                        // $(\".drilldown\" + reportinstance + \" .ui-dialog-title\").html(args.reportname);\r\n\r\n                        if (args.reportname == 'Users profile' || args.reportname == 'Course profile' || args.reportname == 'Statistic') {\r\n                            $(\"#reporttable_\" + reportinstance + \"_wrapper .co_report_header\").remove();\r\n                            $(\"#reporttable_\" + reportinstance + \"_wrapper .co_report_footer\").remove();\r\n                        }\r\n\r\n                        $('.download_menu' + reportinstance + ' li a').each(function(index) {\r\n                            var link = $(this).attr('href');\r\n                            if (typeof args.basicparams != 'undefined') {\r\n                                var basicparamsdata = JSON.parse(args.basicparams);\r\n                                $.each(basicparamsdata, function(key, value) {\r\n                                    if (key.indexOf('filter_') == 0) {\r\n                                        link += '&' + key + '=' + value;\r\n                                    }\r\n                                });\r\n                            }\r\n                            if (typeof(args.filters) != 'undefined') {\r\n                                var filters = JSON.parse(args.filters);\r\n                                $.each(filters, function(key, value) {\r\n                                    if (key.indexOf('filter_') == 0) {\r\n                                        link += '&' + key + '=' + value;\r\n                                    } \r\n                                    if (key.indexOf('date_') == 0) {\r\n                                        if ($.inArray('enabled', value)) {\r\n                                            $.each(value, function(value1, value2) {\r\n                                                link += '&' + key + '[' +value1 + ']=' + value2;\r\n                                            });\r\n                                        }\r\n                                    }\r\n                                    if(key.indexOf('ls_') == 0) {\r\n                                        link += '&' + key + '=' + value;\r\n                                    }\r\n                                });\r\n                            }\r\n                            $(this).attr('href', link);\r\n                        });\r\n                    },\r\n                    \"fnRowCallback\": function(nRow, aData, iDisplayIndex) {\r\n                        $(nRow).children().each(function(index, td) {\r\n                            $(td).css(\"word-break\", args.columnDefs[index].wrap);\r\n                            $(td).css(\"width\", args.columnDefs[index].width);\r\n                        });\r\n                        return nRow;\r\n                    },\r\n                    \"autoWidth\": false,\r\n                    'aaSorting': [],\r\n                    'language': {\r\n                        'paginate': {\r\n                            'previous': '<',\r\n                            'next': '>'\r\n                        },\r\n                        'sProcessing': \"<img src='\" + M.util.image_url('loading', 'block_learnerscript') + \"'>\",\r\n                        'search': \"_INPUT_\",\r\n                        'searchPlaceholder': M.str.block_learnerscript.search,\r\n                        'lengthMenu': \"_MENU_\",\r\n                        \"emptyTable\": M.str.block_learnerscript.nodataavailable,\r\n                    },\r\n                    \"lengthMenu\": lengthoptions\r\n                });\r\n\r\n            $(\".drilldown\" + reportinstance + \" .ui-dialog-title\").html(args.reportname);\r\n            $(\"#page-blocks-learnerscript-viewreport #reporttable_\" + args.reportid + \"_wrapper div.report_header_showhide\").\r\n            html($('#export_options' + args.reportid).html());\r\n            if ($('.reportcalculation' + args.reportid).length > 0) {\r\n                $(\"#page-blocks-learnerscript-viewreport #reporttable_\" + args.reportid + \"_wrapper div.report_calculation_showhide\").\r\n                html('<img src=\"' + M.util.image_url('calculationicon', 'block_learnerscript') + '\" onclick=\"(function(e){ require(\\'block_learnerscript/helper\\').reportCalculations({reportid:' + args.reportid + '}) })(event)\" title =\"Calculations\" />');\r\n            }\r\n            // $('#export_options' + args.reportid).remove();\r\n        },\r\n\r\n\r\n        TpReportDatatable: function(args) {\r\n\r\n            var self = this;\r\n\r\n            \r\n            console.log(args);\r\n            var params = {};\r\n            var reportinstance = args.instanceid ? args.instanceid : args.reportid;\r\n            params['filters'] = args.filters;\r\n            params['basicparams'] = args.basicparams || JSON.stringify(smartfilter.BasicparamsData(reportinstance));\r\n            params['reportid'] = args.reportid;\r\n            params['columns'] = args.columns;\r\n            //\r\n            // Pipelining function for DataTables. To be used to the `ajax` option of DataTables\r\n            //\r\n            $.fn.dataTable.pipeline = function(opts) {\r\n                // Configuration options\r\n                var conf = $.extend({\r\n                    url: '', // script url\r\n                    data: null, // function or object with parameters to send to the server\r\n                    method: 'POST' // Ajax HTTP method\r\n                }, opts);\r\n\r\n                return function(request, drawCallback, settings) {\r\n                    var ajax = true;\r\n                    var requestStart = request.start;\r\n                    var drawStart = request.start;\r\n                    var requestLength = request.length;\r\n                    var requestEnd = requestStart + requestLength;\r\n\r\n                    if (typeof args.data != 'undefined' && request.draw == 1) {\r\n                        json = args.data;\r\n                        json.draw = request.draw; // Update the echo for each response\r\n                        json.data.splice(0, requestStart);\r\n                        json.data.splice(requestLength, json.data.length);\r\n                        drawCallback(json);\r\n                    } else if (ajax) {\r\n                        // Need data from the server\r\n                        request.start = requestStart;\r\n                        request.length = requestLength;\r\n                        $.extend(request, conf.data);\r\n\r\n                        settings.jqXHR = $.ajax({\r\n                            \"type\": conf.method,\r\n                            \"url\": conf.url,\r\n                            \"data\": request,\r\n                            \"dataType\": \"json\",\r\n                            \"cache\": false,\r\n                            \"success\": function(json) {\r\n                                drawCallback(json);\r\n                            }\r\n                        });\r\n                    } else {\r\n                        json = $.extend(true, {}, cacheLastJson);\r\n                        json.draw = request.draw; // Update the echo for each response\r\n                        json.data.splice(0, requestStart - cacheLower);\r\n                        json.data.splice(requestLength, json.data.length);\r\n                        drawCallback(json);\r\n                    }\r\n                }\r\n            };\r\n            if (args.reportname == 'Users profile' || args.reportname == 'Course profile') {\r\n                var lengthoptions = [\r\n                    [50, 100, -1],\r\n                    [\"Show 50\", \"Show 100\", \"Show All\"]\r\n                ];\r\n            } else {\r\n                var lengthoptions = [\r\n                    [10, 25, 50, 100, -1],\r\n                    [\"Show 10\", \"Show 25\", \"Show 50\", \"Show 100\", \"Show All\"]\r\n                ];\r\n            }\r\n            var tpdata = {id: '66', filter_code: 'BV1P7547S2023072739721', filter_trainingprogram: '7547', filter_virtualactivities:'2478'}\r\n             helper.TpDrilldownReport(args);\r\n            // var searchstring = M.str.block_learnerscript.search;\r\n            var oTable = $('#reporttable_' + reportinstance).DataTable({\r\n                'processing': true,\r\n                'serverSide': true,\r\n                'destroy': true,\r\n                'dom': '<\"co_report_header\"Bf <\"report_header_skew\"  <\"report_header_skew_content\" Bl<\"report_header_showhide\" ><\"report_calculation_showhide\" >> > > tr <\"co_report_footer\"ip>',\r\n                'ajax': $.fn.dataTable.pipeline({\r\n                    \"type\": \"POST\",\r\n                    \"url\": M.cfg.wwwroot + '/blocks/learnerscript/components/datatable/server_processing.php?sesskey=' + M.cfg.sesskey,\r\n                    \"data\": params\r\n                }),\r\n                'columnDefs': args.columnDefs,\r\n                // \"fnDrawCallback\": function(oSettings, json) {\r\n                //     chart.SparkLineReport();\r\n                    \r\n                // },\r\n                \"oScroll\": {},\r\n                'responsive': true,\r\n                \"fnInitComplete\": function() {\r\n\r\n                    this.fnAdjustColumnSizing(true);\r\n                    // $(\".drilldown\" + reportinstance + \" .ui-dialog-title\").html(args.reportname);\r\n\r\n                    if (args.reportname == 'Users profile' || args.reportname == 'Course profile' || args.reportname == 'Statistic') {\r\n                        $(\"#reporttable_\" + reportinstance + \"_wrapper .co_report_header\").remove();\r\n                        $(\"#reporttable_\" + reportinstance + \"_wrapper .co_report_footer\").remove();\r\n                    }\r\n\r\n                    $('.download_menu' + reportinstance + ' li a').each(function(index) {\r\n                        var link = $(this).attr('href');\r\n                        if (typeof args.basicparams != 'undefined') {\r\n                            var basicparamsdata = JSON.parse(args.basicparams);\r\n                            $.each(basicparamsdata, function(key, value) {\r\n                                if (key.indexOf('filter_') == 0) {\r\n                                    link += '&' + key + '=' + value;\r\n                                }\r\n                            });\r\n                        }\r\n                        if (typeof(args.filters) != 'undefined') {\r\n                            var filters = JSON.parse(args.filters);\r\n                            $.each(filters, function(key, value) {\r\n                                if (key.indexOf('filter_') == 0) {\r\n                                    link += '&' + key + '=' + value;\r\n                                } \r\n                                if (key.indexOf('date_') == 0) {\r\n                                    if ($.inArray('enabled', value)) {\r\n                                        $.each(value, function(value1, value2) {\r\n                                            link += '&' + key + '[' +value1 + ']=' + value2;\r\n                                        });\r\n                                    }\r\n                                }\r\n                                if(key.indexOf('ls_') == 0) {\r\n                                    link += '&' + key + '=' + value;\r\n                                }\r\n                            });\r\n                        }\r\n                        $(this).attr('href', link);\r\n                    });\r\n                },\r\n                // \"fnRowCallback\": function(nRow, aData, iDisplayIndex) {\r\n                //     $(nRow).children().each(function(index, td) {\r\n                //         $(td).css(\"word-break\", args.columnDefs[index].wrap);\r\n                //         $(td).css(\"width\", args.columnDefs[index].width);\r\n                //     });\r\n                //     return nRow;\r\n                // },\r\n                \"autoWidth\": false,\r\n                'aaSorting': [],\r\n                'language': {\r\n                    'paginate': {\r\n                        'previous': '<',\r\n                        'next': '>'\r\n                    },\r\n                    'sProcessing': \"<img src='\" + M.util.image_url('loading', 'block_learnerscript') + \"'>\",\r\n                    'search': \"_INPUT_\",\r\n                    'searchPlaceholder': 'search',\r\n                    'lengthMenu': \"_MENU_\",\r\n                    \"emptyTable\": \"<div class='alert alert-info'>No data available</div>\"\r\n                },\r\n                \"lengthMenu\": lengthoptions\r\n            });\r\n            $(\".drilldown\" + reportinstance + \" .ui-dialog-title\").html(args.reportname);\r\n            $(\"#page-blocks-learnerscript-viewreport #reporttable_\" + args.reportid + \"_wrapper div.report_header_showhide\").\r\n            html($('#export_options' + args.reportid).html());\r\n            if ($('.reportcalculation' + args.reportid).length > 0) {\r\n                $(\"#page-blocks-learnerscript-viewreport #reporttable_\" + args.reportid + \"_wrapper div.report_calculation_showhide\").\r\n                html('<img src=\"' + M.util.image_url('calculationicon', 'block_learnerscript') + '\" onclick=\"(function(e){ require(\\'block_learnerscript/helper\\').reportCalculations({reportid:' + args.reportid + '}) })(event)\" title =\"Calculations\" />');\r\n            }\r\n            // $('#export_options' + args.reportid).remove();\r\n        },\r\n        AddExpressions: function(e, value) {\r\n            $(e.target).on('select2:unselecting', function(e){\r\n                $('#fitem_id_'+e.params.args.data.id+'').remove();\r\n            });\r\n            var columns = $(e.target).val();\r\n            $.each(columns, function(index){\r\n                if($('#fitem_id_'+columns[index]).length > 0){\r\n                    return;\r\n                }\r\n                var column = [];\r\n                 column['name'] = columns[index];\r\n                 column.conditionsymbols = [];\r\n                 var conditions = [\"=\", \">\", \"<\", \">=\", \"<=\", \"<>\"];\r\n                 $.each(conditions, function(index, value){\r\n                    column.conditionsymbols.push({\r\n                        'value': value\r\n                    })\r\n                 });\r\n                var requestdata = { column: column };\r\n                templates.render('block_learnerscript/plotconditions', requestdata).then(function(html){\r\n                    //$(e.target).closest('form').find('#fitem_id_yaxis_bar').after(html);\r\n                    //$(e.target).closest('form').find('#fitem_id_yaxis').after(html);\r\n                    if(value == 'yaxisbarvalue') {\r\n                        $('#yaxis_bar1').append(html);\r\n                    } else {\r\n                        $('#yaxis1').append(html);\r\n                    }\r\n\r\n                }).fail(function(ex){});\r\n            });\r\n        },\r\n        block_statistics_help: function(reportid){\r\n                var promise = ajax.call({\r\n                    args: {\r\n                        action: 'learnerscriptdata',\r\n                        reportid: reportid\r\n                    },\r\n                    url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\",\r\n                });\r\n                promise.done(function(response) {\r\n                   require(['core/modal_factory'], function(ModalFactory) {\r\n                        ModalFactory.create({\r\n                            title: response.name,\r\n                            body: response.summary,\r\n                            footer: '',\r\n                        }).done(function(modal) {\r\n                            dialogue = modal;\r\n                            ModalEvents = require('core/modal_events');\r\n                            dialogue.getRoot().on(ModalEvents.hidden, function() {\r\n                                //window.location = M.cfg.wwwroot + '/blocks/learnerscript/viewreport.php?id=' + 10;\r\n                            });\r\n\r\n                            dialogue.show();\r\n                        });\r\n                    });\r\n                });\r\n        }\r\n       \r\n    };\r\n\r\n});\r\n"],"names":["define","Str","select2","DataTable","reportwidget","chart","smartfilter","helper","AjaxForms","ajax","$","RadiosToSlider","flatpickr","templates","report","BasicparamCourse","BasicparamUser","BasicparamActivity","FilterCourse","FilterUser","FilterActivity","FilterModule","FilterCohort","NumberOfBasicParams","init","args","ui","dialog","prototype","_focusTabbable","noop","fn","dataTable","ext","errMode","on","reportid","this","data","removeClass","addClass","html","theme","e","val","length","preventDefault","trigger","change","find","window","location","M","cfg","wwwroot","size","animation","reportdashboard","mode","onOpen","selectedDates","dateStr","instance","clear","onClose","getTime","require","CreateReportPage","instanceid","cohortid","FirstElementActive","CohortUsers","reporttype","firstelementactive","courseid","CourseData","courseEvolutions","categoryid","categoryCourses","programid","programofferings","offeringid","offeringmeetings","moduleinstance","meetingdates","trainingproviderid","trainerslist","typeid","orgslist","schedule","SelectRoleUsers","basicparams","name","hide","attr","click","parent","CourseActivities","document","ajaxComplete","event","xhr","settings","reset","validate","getreport","validatebasicform","stopImmediatePropagation","show","currentTarget","value","removeAttr","inArray","url","indexOf","ajaxaction","parseJSON","basicparam","action","disabletable","HighchartsAjax","cols","CreateDashboardwidget","generate_plotgraph","response","containerid","reportinstance","type","piechart","lbchart","solidgauge","combinationchart","WorldMap","TreeMap","ReportDatatable","params","filters","JSON","stringify","BasicparamsData","columns","pipeline","opts","conf","extend","method","request","drawCallback","requestStart","start","requestLength","draw","json","splice","jqXHR","reportname","lengthoptions","sesskey","columnDefs","oSettings","SparkLineReport","DrilldownReport","fnAdjustColumnSizing","remove","each","index","link","basicparamsdata","parse","key","value1","value2","nRow","aData","iDisplayIndex","children","td","css","wrap","width","util","image_url","str","block_learnerscript","search","nodataavailable","TpReportDatatable","console","log","TpDrilldownReport","AddExpressions","target","id","column","conditionsymbols","push","requestdata","render","then","append","fail","ex","block_statistics_help","call","done","ModalFactory","create","title","body","summary","footer","modal","dialogue","ModalEvents","getRoot","hidden"],"mappings":"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"}